(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-question-question_view"],{"145e5":function(t,e,n){"use strict";n.r(e);var i=n("aea8"),a=n("702e");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);var o,r=n("f0c5"),u=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);e["default"]=u.exports},"1c72":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.ListerMixin=e.ComponentListerMixin=void 0,n("ac1f"),n("841c"),n("4de4"),n("99af"),n("d81d");var i=n("379e"),a={data:function(){return{listLoading:!1,order:{field:null,type:"asc"},list:{page:1,pageSize:10,records:[],total:0},selectIds:[],filter:[],search:{}}},onPullDownRefresh:function(t){this.doSearch()},onReachBottom:function(t){this.doNextPage()},methods:{HandleInput:i.HandleInput,RouterTo:i.RouterTo,init:function(){this.$refs.listStatus.init(),this.doList(1)},doSearch:function(){this.$refs.listStatus.init(),this.doList(1)},doSearchReset:function(){t.log("implements doSearchReset")},onSortChange:function(t,e,n){null===n?(this.order.field=null,this.order.type=null):(this.order.field=t.prop,this.order.type="ascending"===n?"asc":"desc"),this.doList(1)},doList:function(e){t.error("should implements doList")},doListProcess:function(t,e,n,i){var a=this;n=n||{},e=e||this.list.page,this.list.page=e,1===this.list.page&&(this.list.records=[]),this.listLoading=!0,this.$api.post(t,Object.assign({order:JSON.stringify(this.order),search:JSON.stringify(this.search),filter:JSON.stringify(this.filter),page:this.list.page,pageSize:this.list.pageSize},n),(function(t){a.listLoading=!1,uni.stopPullDownRefresh(),a.list.page=t.data.page,a.list.pageSize=t.data.pageSize,a.list.records=a.list.records.concat(t.data.records),a.list.total=t.data.total,t.data.records.length!==t.data.pageSize&&a.$refs.listStatus&&a.$refs.listStatus.noMore(),i&&i(t)}),(function(t){a.listLoading=!1,uni.stopPullDownRefresh()}))},doNextPage:function(){this.$refs.listStatus.shouldNext()&&this.doList(this.list.page+1)}}};e.ComponentListerMixin=a;var s={data:function(){return{mode:"concat",listLoading:!1,order:{field:null,type:"asc"},list:{page:1,pageSize:10,records:[],total:0},selectIds:[],filter:[],search:{}}},onReady:function(){var t=this;this.$starter.boot((function(){t.init()}))},onPullDownRefresh:function(t){this.doSearch()},onReachBottom:function(t){this.doNextPage()},mounted:function(){},methods:{HandleInput:i.HandleInput,RouterTo:i.RouterTo,init:function(){this.$refs.listStatus&&this.$refs.listStatus.init(),this.doList(1)},doSearch:function(){this.$refs.listStatus&&this.$refs.listStatus.init(),this.doList(1)},doSearchReset:function(){t.log("implements doSearchReset")},onSortChange:function(t){var e=t.item;e?(this.order.field=e.field,this.order.type=e.type):(this.order.field=null,this.order.type=null),this.doSearch()},doList:function(e){t.error("should implements doList")},doListProcess:function(t,e,n,i){var a=this;n=n||{},e=e||this.list.page,this.list.page=e,this.listLoading=!0,this.$api.post(t,Object.assign({order:JSON.stringify(this.order),search:JSON.stringify(this.search),filter:JSON.stringify(this.filter),page:this.list.page,pageSize:this.list.pageSize},n),(function(t){a.listLoading=!1,uni.stopPullDownRefresh(),1===a.list.page&&(a.list.records=[]),a.list.page=t.data.page,a.list.pageSize=t.data.pageSize,"concat"===a.mode?a.list.records=a.list.records.concat(t.data.records):a.list.records=t.data.records,a.list.total=t.data.total,t.data.records.length!==t.data.pageSize&&a.$refs.listStatus&&a.$refs.listStatus.noMore(),i&&i(t)}),(function(t){a.listLoading=!1,uni.stopPullDownRefresh()}))},doNextPage:function(){this.$refs.listStatus.shouldNext()&&this.doList(this.list.page+1)},onTableSelectChange:function(t){this.selectIds=t.map((function(t){return t.id}))}}};e.ListerMixin=s}).call(this,n("5a52")["default"])},2820:function(t,e,n){"use strict";var i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("4160"),n("159b");var a=i(n("47f7")),s=i(n("2e02")),o=i(n("3cd9")),r=i(n("145e5")),u={name:"question_view",components:{QuestionTools:r.default,QuestionCommentPost:o.default,QuestionCommentList:s.default,QuestionViewItem:a.default},data:function(){return{questionData:null,hasFavorite:!1}},onReady:function(){var t=this;this.$starter.boot((function(){t.init()}))},methods:{onQuestionDataUpdate:function(t,e,n){n>=0?this.$set(this.questionData.items,n,t):this.questionData=t},init:function(){var t=this;this.$api.post("question/get",{alias:this.$r.getQuery("alias"),search:JSON.stringify(this.$r.getQueryJson("search"))},(function(e){var n=e.data.questionData;t.hasFavorite=e.data.hasFavorite,n._done=!1,n._correct=!1,n.options&&n.options.forEach((function(t){t._checked=!1})),n.items&&n.items.forEach((function(t){t._done=!1,t._correct=!1,t.options&&t.options.forEach((function(t){t._checked=!1}))})),t.questionData=n}))},doCommentUpdate:function(){this.$refs.commentList.doList()},onFavoriteChange:function(t){this.hasFavorite=t}}};e.default=u},"2dce":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var i={pageMeta:n("6d42").default},a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("page-meta",{attrs:{"root-font-size":"20px"}}),t.questionData?n("v-uni-view",[n("page-header",{attrs:{title:t.questionData.question.questionText}}),n("QuestionViewItem",{attrs:{"question-data":t.questionData,"paper-question-number-show":!1,"paper-question-number":1},on:{"on-question-data-update":function(e){arguments[0]=e=t.$handleEvent(e),t.onQuestionDataUpdate.apply(void 0,arguments)}}}),n("QuestionTools",{attrs:{"question-data":t.questionData,"has-favorite":t.hasFavorite},on:{"on-favorite-change":function(e){arguments[0]=e=t.$handleEvent(e),t.onFavoriteChange.apply(void 0,arguments)}}}),t.$store.state.base.biz.Question_CommentEnable?n("QuestionCommentList",{ref:"commentList",attrs:{"question-data":t.questionData}}):t._e(),t.$store.state.base.biz.Question_CommentEnable?n("QuestionCommentPost",{attrs:{"question-data":t.questionData},on:{update:function(e){arguments[0]=e=t.$handleEvent(e),t.doCommentUpdate.apply(void 0,arguments)}}}):t._e()],1):t._e()],1)},s=[]},"2e02":function(t,e,n){"use strict";n.r(e);var i=n("9039"),a=n("d7f6");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);var o,r=n("f0c5"),u=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);e["default"]=u.exports},"3cd9":function(t,e,n){"use strict";n.r(e);var i=n("c4e9"),a=n("db41");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);var o,r=n("f0c5"),u=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);e["default"]=u.exports},4825:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"QuestionTools",props:{questionData:{type:Object,default:null},hasFavorite:{type:Boolean,default:!1}},methods:{doAction:function(t){var e=this;this.$api.post("question_favorite_member/submit",{categoryId:this.questionData.question.id,action:t},(function(n){switch(t){case"favorite":e.$emit("on-favorite-change",!0);break;case"unfavorite":e.$emit("on-favorite-change",!1);break}}))}}};e.default=i},"4d23":function(t,e,n){"use strict";var i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("4a9c"),s=n("1c72"),o=i(n("89c2")),r=i(n("652b")),u={name:"QuestionCommentList",components:{Pagination:r.default,TimeAgoField:o.default},mixins:[a.StoreUserMixin,s.ListerMixin],props:{questionData:{type:Object,default:null}},data:function(){return{mode:"list"}},mounted:function(){this.doList(1)},methods:{doList:function(t){this.doListProcess("question_comment/list",t,{alias:this.questionData.question.alias})},doDelete:function(t){var e=this;this.$dialog.confirm("确定删除？",(function(){e.$api.post("question_comment/delete",{id:t},(function(t){e.doList()}))}))}}};e.default=u},"652b":function(t,e,n){"use strict";n.r(e);var i=n("e671"),a=n("ee28");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);var o,r=n("f0c5"),u=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);e["default"]=u.exports},"702e":function(t,e,n){"use strict";n.r(e);var i=n("4825"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},8417:function(t,e,n){"use strict";n.r(e);var i=n("2dce"),a=n("d58f5");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);var o,r=n("f0c5"),u=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,"cb440e9a",null,!1,i["a"],o);e["default"]=u.exports},"89c2":function(t,e,n){"use strict";n.r(e);var i=n("9aa5"),a=n("e1d8");for(var s in a)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(s);var o,r=n("f0c5"),u=Object(r["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],o);e["default"]=u.exports},"8d9c":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("4a9c"),a=n("379e"),s={name:"QuestionCommentPost",mixins:[i.StoreUserMixin],props:{questionData:{type:Object,default:null}},data:function(){return{data:{content:""}}},methods:{UserRouterTo:a.UserRouterTo,HandleInput:a.HandleInput,doSubmit:function(){var t=this;this.$dialog.loadingOn(),this.$api.post("question_comment/post",{alias:this.questionData.question.alias,content:this.data.content},(function(e){t.$dialog.loadingOff(),t.$dialog.tipSuccess("评论成功"),t.$emit("update"),t.data.content=""}),(function(e){t.$dialog.loadingOff()}))}}};e.default=s},9039:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"ub-panel margin-top"},[n("v-uni-view",{staticClass:"head"},[n("v-uni-view",{staticClass:"title"},[t._v("用户评论")])],1),n("v-uni-view",{staticClass:"body"},[t.list.records.length?t._e():n("list-no-records"),n("v-uni-view",{staticClass:"ub-comment-list"},t._l(t.list.records,(function(e,i){return n("v-uni-view",{key:i,staticClass:"comment-item"},[n("v-uni-view",{staticClass:"comment-head"},[n("v-uni-view",{staticClass:"user-avatar"},[n("v-uni-image",{staticClass:"image",attrs:{src:e._memberUser.avatar}})],1),n("v-uni-view",{staticClass:"user-name"},[t._v(t._s(e._memberUser.username||"[已删除用户]"))]),n("v-uni-view",{staticClass:"time"},[n("v-uni-text",{staticClass:"ub-text-muted"},[t._v("发表于")]),n("TimeAgoField",{staticClass:"margin-left",attrs:{value:e.created_at}})],1)],1),n("v-uni-view",{staticClass:"comment-body"},[n("v-uni-view",{staticClass:"ub-html content",domProps:{innerHTML:t._s(e.content)}})],1),n("v-uni-view",{staticClass:"comment-foot"},[n("v-uni-view",{staticClass:"action"},[t.user.id==e.memberUserId?n("v-uni-text",{staticClass:"ub-text-danger",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.doDelete(e.id)}}},[t._v("删除")]):t._e()],1),n("v-uni-view",{staticClass:"item"},[t._v("")])],1)],1)})),1),t.list.total.length>0?n("v-uni-view",{staticClass:"ub-text-center"},[n("Pagination",{attrs:{page:t.list.page,"page-size":t.list.pageSize,total:t.list.total},on:{"current-change":function(e){arguments[0]=e=t.$handleEvent(e),t.doList.apply(void 0,arguments)}}})],1):t._e()],1)],1)},s=[]},"9aa5":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-text",[t._v(t._s(t.time))])},s=[]},aea8:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.questionData?n("v-uni-view",{staticClass:"ub-panel margin-top-lg"},[n("v-uni-view",{staticClass:"body"},[n("v-uni-view",{staticClass:"ub-tools"},[t.hasFavorite?n("v-uni-view",{staticClass:"item active",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doAction("unfavorite")}}},[n("v-uni-text",{staticClass:"icon iconfont"},[t._v("")]),n("v-uni-text",{staticClass:"text"},[t._v("已收藏")])],1):n("v-uni-view",{staticClass:"item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doAction("favorite")}}},[n("v-uni-text",{staticClass:"icon iconfont"},[t._v("")]),n("v-uni-text",{staticClass:"text"},[t._v("收藏")])],1)],1)],1)],1):t._e()},s=[]},b18d:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n("c72b"),a={name:"TimeAgoField",computed:{time:function(){return this.value?(0,i.format)(this.value,"zh_CN"):"-"}},props:{value:null}};e.default=a},c4e9:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"ub-panel margin-top"},[n("v-uni-view",{staticClass:"head"},[n("v-uni-view",{staticClass:"title"},[t._v("发表评论")])],1),n("v-uni-view",{staticClass:"body"},[t.user.id?n("v-uni-view",[n("v-uni-view",[n("v-uni-textarea",{attrs:{maxlength:"-1",placeholder:"点击填写评论内容","auto-height":!0,value:t.data.content,"data-name":"data.content"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.HandleInput.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"margin-top"},[n("v-uni-button",{staticClass:"btn btn-lg btn-primary",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.doSubmit.apply(void 0,arguments)}}},[t._v("提交评论")])],1)],1):n("v-uni-view",{staticClass:"ub-text-center",staticStyle:{padding:"2.5rem 0"}},[t._v("请"),n("smart-link",{staticClass:"ub-text-link margin-left margin-right primary",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.UserRouterTo(t.$r.pathWithQueries())}}},[t._v("登录")]),t._v("后再回复")],1)],1)],1)},s=[]},c72b:function(t,e,n){"use strict";n.r(e),n.d(e,"format",(function(){return p})),n.d(e,"render",(function(){return y})),n.d(e,"cancel",(function(){return $})),n.d(e,"register",(function(){return u}));var i=["second","minute","hour","day","week","month","year"],a=function(t,e){if(0===e)return["just now","right now"];var n=i[Math.floor(e/2)];return t>1&&(n+="s"),[t+" "+n+" ago","in "+t+" "+n]},s=["秒","分钟","小时","天","周","个月","年"],o=function(t,e){if(0===e)return["刚刚","片刻后"];var n=s[~~(e/2)];return[t+" "+n+"前",t+" "+n+"后"]},r={},u=function(t,e){r[t]=e},c=function(t){return r[t]||r["en_US"]},l=[60,60,24,7,365/7/12,12];function d(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function f(t,e){var n=t<0?1:0;t=Math.abs(t);for(var i=t,a=0;t>=l[a]&&a<l.length;a++)t/=l[a];return t=Math.floor(t),a*=2,t>(0===a?9:1)&&(a+=1),e(t,a,i)[n].replace("%s",t.toString())}function v(t,e){var n=e?d(e):new Date;return(+n-+d(t))/1e3}function h(t){for(var e=1,n=0,i=Math.abs(t);t>=l[n]&&n<l.length;n++)t/=l[n],e*=l[n];return i%=e,i=i?e-i:e,Math.ceil(i)}var p=function(t,e,n){var i=v(t,n&&n.relativeDate);return f(i,c(e))},m="timeago-id";function g(t){return t.getAttribute("datetime")}function b(t,e){t.setAttribute(m,e)}function _(t){return parseInt(t.getAttribute(m))}var x={},C=function(t){clearTimeout(t),delete x[t]};function w(t,e,n,i){C(_(t));var a=i.relativeDate,s=i.minInterval,o=v(e,a);t.innerText=f(o,n);var r=setTimeout((function(){w(t,e,n,i)}),Math.min(1e3*Math.max(h(o),s||1),2147483647));x[r]=0,b(t,r)}function $(t){t?C(_(t)):Object.keys(x).forEach(C)}function y(t,e,n){var i=t.length?t:[t];return i.forEach((function(t){w(t,g(t),c(e),n||{})})),i}u("en_US",a),u("zh_CN",o)},d58f5:function(t,e,n){"use strict";n.r(e);var i=n("2820"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},d7f6:function(t,e,n){"use strict";n.r(e);var i=n("4d23"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},db41:function(t,e,n){"use strict";n.r(e);var i=n("8d9c"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},e1d8:function(t,e,n){"use strict";n.r(e);var i=n("b18d"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},e671:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"ub-paginate-mobile"},[n("v-uni-view",{staticClass:"ub-paginate-mobile__btn",class:1===t.currentIndex?"ub-paginate-mobile--disabled":"ub-paginate-mobile--enabled",attrs:{"hover-class":1===t.currentIndex?"":"ub-paginate-mobile--hover","hover-start-time":20,"hover-stay-time":70},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clickLeft.apply(void 0,arguments)}}},[t.showIcon?[n("v-uni-text",{staticClass:"iconfont icon-angleleft"})]:[n("v-uni-text",{staticClass:"ub-paginate-mobile__child-btn"},[t._v(t._s(t.prevText))])]],2),n("v-uni-view",{staticClass:"ub-paginate-mobile__num"},[n("v-uni-view",{staticClass:"ub-paginate-mobile__num-page"},[n("v-uni-text",{staticClass:"ub-paginate-mobile__num-page-text current"},[t._v(t._s(t.currentIndex))]),n("v-uni-text",{staticClass:"ub-paginate-mobile__num-page-text"},[t._v("/"+t._s(t.maxPage||0))])],1)],1),n("v-uni-view",{staticClass:"ub-paginate-mobile__btn",class:t.currentIndex===t.maxPage?"ub-paginate-mobile--disabled":"ub-paginate-mobile--enabled",attrs:{"hover-class":t.currentIndex===t.maxPage?"":"ub-paginate-mobile--hover","hover-start-time":20,"hover-stay-time":70},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clickRight.apply(void 0,arguments)}}},[t.showIcon?[n("v-uni-text",{staticClass:"iconfont icon-angle2"})]:[n("v-uni-text",{staticClass:"ub-paginate-mobile__child-btn"},[t._v(t._s(t.nextText))])]],2)],1)},s=[]},ee28:function(t,e,n){"use strict";n.r(e);var i=n("fda3"),a=n.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=a.a},fda3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("a9e3");var i={name:"Pagination",props:{prevText:{type:String,default:"上一页"},nextText:{type:String,default:"下一页"},page:{type:Number,default:1},total:{type:Number,default:0},pageSize:{type:Number,default:10},showIcon:{type:Boolean,default:!1}},data:function(){return{currentIndex:1}},computed:{maxPage:function(){var t=1,e=Number(this.total),n=Number(this.pageSize);return e&&n&&(t=Math.ceil(e/n)),t}},watch:{page:function(t){this.currentIndex=t}},created:function(){this.currentIndex=this.page},methods:{clickLeft:function(){1!==Number(this.currentIndex)&&(this.currentIndex-=1,this.change("prev"))},clickRight:function(){Number(this.currentIndex)!==this.maxPage&&(this.currentIndex+=1,this.change("next"))},change:function(t){this.$emit("change",{type:t,page:this.currentIndex}),this.$emit("current-change",this.currentIndex)}}};e.default=i}}]);