<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Util; use ModStart\Core\Dao\ModelUtil; use Module\Vendor\Cache\CacheUtil; class MemberGroupUtil { public static function all() { return CacheUtil::rememberForever('MemberGroupList', function () { return ModelUtil::all('member_group', array(), array('*'), array('id', 'asc')); }); } public static function mapIdTitle() { return array_build(self::all(), function ($nJFbs, $NIxlc) { return array($NIxlc['id'], $NIxlc['title']); }); } public static function defaultGroup() { foreach (self::all() as $RLvq6) { if ($RLvq6['isDefault']) { return $RLvq6; } } return null; } public static function defaultGroupId() { $RLvq6 = self::defaultGroup(); return $RLvq6 ? $RLvq6['id'] : 0; } public static function map() { return CacheUtil::rememberForever('MemberGroupMap', function () { return array_build(self::all(), function ($nJFbs, $NIxlc) { return array($NIxlc['id'], $NIxlc); }); }); } public static function get($FPRpI) { goto ELsUh; xnXIM: return null; goto p4WzY; j5GJK: if (null === $TbleL) { $TbleL = self::map(); } goto zmg8d; zmg8d: if (empty($FPRpI)) { foreach ($TbleL as $REa1I) { if ($REa1I['isDefault']) { return $REa1I; } } return null; } goto q3ONF; ELsUh: static $TbleL = null; goto j5GJK; q3ONF: if (isset($TbleL[$FPRpI])) { return $TbleL[$FPRpI]; } goto xnXIM; p4WzY: } public static function getMemberGroup($w45m7) { if (empty($w45m7)) { return null; } return self::get($w45m7['groupId']); } public static function clearCache() { CacheUtil::forget('MemberGroupList'); CacheUtil::forget('MemberGroupMap'); } }