<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Config; use Illuminate\Support\Str; class MemberMenu { private static $menu = array(); public static function register($NOoJU) { self::$menu[] = $NOoJU; } public static function get() { goto pza_O; NDLRL: return $NOoJU; goto y8V7d; xKLwr: $NOoJU = self::mergeMenu($NOoJU); goto NDLRL; pza_O: $NOoJU = array(); goto bR4Ra; bR4Ra: foreach (self::$menu as $REa1I) { if ($REa1I instanceof \Closure) { $REa1I = call_user_func($REa1I); } $NOoJU = array_merge($NOoJU, $REa1I); } goto xKLwr; y8V7d: } private static function sort() { static $EnCPs = 1000; return $EnCPs++; } private static function mergeMenu($NOoJU, $JAbBw = '', $XaPco = 1, $qM7YH = null) { goto YY2eH; X9Wen: $ImKSz = array(); goto XjmjT; ijLio: return $ImKSz; goto nN0Jj; YY2eH: if (empty($NOoJU)) { return array(); } goto X9Wen; XjmjT: foreach ($NOoJU as $REa1I) { goto Rha4L; dA0u2: if (!isset($ImKSz[$nJFbs])) { $ImKSz[$nJFbs] = $REa1I; } goto MH5qm; lYmyF: if (isset($REa1I['icon'])) { if (preg_match('/^[a-zA-Z0-9\\-]+$/', $REa1I['icon'])) { $REa1I['icon'] = "<i class='icon iconfont icon-{$REa1I['icon']}'></i>"; } } goto dA0u2; Rha4L: if (empty($REa1I)) { continue; } goto QwWhx; QwWhx: if ($qM7YH) { if (!call_user_func($qM7YH, $REa1I)) { continue; } } goto aYalJ; Ty4AJ: if (!empty($REa1I['children'])) { $ImKSz = array_merge($ImKSz, self::mergeMenu($REa1I['children'], $nJFbs . '^^', $XaPco + 1, $qM7YH)); } goto qxZlI; MH5qm: unset($ImKSz[$nJFbs]['children']); goto Ty4AJ; LDiTJ: if (1 == $XaPco) { $nJFbs = $JAbBw . $REa1I['title'] . '^' . $REa1I['icon'] . '^' . $REa1I['sort']; } else { $nJFbs = $JAbBw . $REa1I['title']; } goto lYmyF; aYalJ: if (!isset($REa1I['sort'])) { $REa1I['sort'] = self::sort(); } goto LDiTJ; qxZlI: } goto JbTgA; JbTgA: if ($XaPco == 1) { uasort($ImKSz, function ($aYvm6, $QF8Y3) { return $aYvm6['sort'] - $QF8Y3['sort']; }); return self::mergeMenuTree($ImKSz); } goto ijLio; nN0Jj: } private static function mergeMenuTree($RkakG, $JAbBw = '') { goto UZrZJ; xusT1: foreach ($RkakG as $nJFbs => $NIxlc) { goto ybJw8; UXPeX: if ($JAbBw) { if (!Str::startsWith($nJFbs, $JAbBw)) { continue; } if (count(explode('^^', $JAbBw)) !== count(explode('^^', $nJFbs))) { continue; } } else { if (1 != count($Oh5ND)) { continue; } } goto WyAtW; ybJw8: if ($nJFbs === $JAbBw) { continue; } goto oZgst; chzvn: $m0MLE[] = $REa1I; goto bbQ2x; WyAtW: $REa1I = $NIxlc; goto Qv12G; B2wZ9: if (empty($REa1I['children']) && empty($REa1I['url'])) { continue; } goto chzvn; l90pj: if (empty($REa1I['children'])) { unset($REa1I['children']); } goto B2wZ9; Qv12G: $REa1I['children'] = self::mergeMenuTree($RkakG, $nJFbs . '^^'); goto l90pj; oZgst: $Oh5ND = explode('^^', $nJFbs); goto UXPeX; bbQ2x: } goto i5kS5; i5kS5: return $m0MLE; goto yHuca; UZrZJ: $m0MLE = array(); goto xusT1; yHuca: } }