<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Oauth; use ModStart\Core\Input\Response; use Module\Member\Util\MemberUtil; abstract class AbstractOauth { public function hasRender() { return true; } public function isSupport() { return true; } public function color() { return null; } public function title() { return $this->name(); } public function oauthKey() { return $this->name(); } public abstract function name(); public abstract function render(); public function bindRender() { return null; } public abstract function processRedirect($oG0tD); public abstract function processLogin($oG0tD); public function processTryLogin($oG0tD) { goto bioAQ; vJsBb: return Response::generateSuccessData(array('memberUserId' => 0)); goto Dp4yP; B5d0P: if ($MqkYF) { return Response::generateSuccessData(array('memberUserId' => $MqkYF)); } goto vJsBb; bioAQ: $qehPa = $oG0tD['userInfo']; goto OMMav; nGtvq: $MqkYF = MemberUtil::getIdByOauthAndCheck($this->name(), $Fe53m); goto B5d0P; OMMav: $Fe53m = $qehPa['openid']; goto nGtvq; Dp4yP: } public function processBindToUser($oG0tD) { goto Nrzig; Z6IeM: if (!empty($qehPa['username'])) { $kkerk['infoUsername'] = $qehPa['username']; } goto TcGqc; u7Gov: MemberUtil::putOauth($MqkYF, $this->name(), $qehPa['openid'], $kkerk); goto w0GVy; Nrzig: $MqkYF = $oG0tD['memberUserId']; goto W75eL; TcGqc: if (!empty($qehPa['avatar'])) { $kkerk['infoAvatar'] = $qehPa['avatar']; } goto u7Gov; G_ZIb: $kkerk = array(); goto Z6IeM; jb7Zv: if ($wa91I && $MqkYF != $wa91I) { MemberUtil::forgetOauth($this->name(), $qehPa['openid']); } goto G_ZIb; W75eL: $qehPa = $oG0tD['userInfo']; goto x25ef; w0GVy: return Response::generateSuccess(); goto Btrsz; x25ef: $wa91I = MemberUtil::getIdByOauthAndCheck($this->name(), $qehPa['openid']); goto jb7Zv; Btrsz: } }