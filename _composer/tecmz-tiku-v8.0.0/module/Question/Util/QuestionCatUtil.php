<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Question\Util; use Illuminate\Support\Facades\Cache; use ModStart\Core\Assets\AssetsUtil; use ModStart\Core\Dao\ModelUtil; class QuestionCatUtil { public static function clearCache() { Cache::forget('QuestionCats'); } public static function allShowing() { return array_values(array_filter(self::all(), function ($vY60h) { return $vY60h['catShow']; })); } public static function getShowing($oUKOQ) { foreach (self::allShowing() as $REa1I) { if ($REa1I['id'] == $oUKOQ) { return $REa1I; } } return null; } public static function all() { return Cache::rememberForever('QuestionCats', function () { $v39Ud = ModelUtil::all('question_cat', array(), array('*'), array('sort', 'asc')); AssetsUtil::recordsFixFullOrDefault($v39Ud, 'bgCover', 'vendor/Question/image/catBgCover.jpg'); return $v39Ud; }); } public static function firstShowingId() { foreach (self::allShowing() as $REa1I) { return $REa1I['id']; } return 0; } public static function firstId() { foreach (self::all() as $REa1I) { return $REa1I['id']; } return 0; } public static function updateCount($sHyeq) { goto NSTFh; W9Nkg: if (empty($sHyeq)) { return; } goto kJJ7G; mOOqw: self::clearCache(); goto jD18f; NSTFh: if (!is_array($sHyeq)) { $sHyeq = array($sHyeq); } goto XgkY3; XgkY3: $sHyeq = array_unique($sHyeq); goto W9Nkg; kJJ7G: foreach ($sHyeq as $oUKOQ) { ModelUtil::update('question_cat', $oUKOQ, array('questionCount' => ModelUtil::count('question', array('catId' => $oUKOQ, 'parentId' => 0)))); } goto mOOqw; jD18f: } }