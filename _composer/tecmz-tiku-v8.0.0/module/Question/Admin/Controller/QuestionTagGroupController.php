<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Question\Admin\Controller; use Illuminate\Routing\Controller; use ModStart\Admin\Concern\HasAdminQuickCRUD; use ModStart\Admin\Layout\AdminCRUDBuilder; use ModStart\Form\Form; use ModStart\Grid\GridFilter; use ModStart\Repository\Filter\RepositoryFilter; use ModStart\Repository\Filter\ScopeFilter; use ModStart\Support\Concern\HasFields; use Module\Question\Util\QuestionCatUtil; use Module\Question\Util\QuestionTagUtil; class QuestionTagGroupController extends Controller { use HasAdminQuickCRUD; protected function crud(AdminCRUDBuilder $cv5kq) { goto OSyOJ; fF2ug: $cv5kq->scopeDefault(QuestionCatUtil::firstId())->repositoryFilter(function (RepositoryFilter $qM7YH) use($cv5kq) { $qM7YH->where('catId', $cv5kq->scopeValue()); $cv5kq->scopeAddedParam(array('catId' => $cv5kq->scopeValue())); })->gridFilter(function (GridFilter $qM7YH) { $qM7YH->eq('id', L('ID')); $qM7YH->like('name', L('Title')); })->hookChanged(function (Form $Yfg4L) { QuestionTagUtil::clearCache(); })->canShow(false)->title('题目标签组')->asTree()->treeMaxLevel(1); goto qCFvC; OSyOJ: $cv5kq->init('question_tag_group')->field(function ($cv5kq) { $cv5kq->id('id', 'ID'); $cv5kq->text('title', '名称'); $cv5kq->display('created_at', L('Created At'))->listable(false); $cv5kq->display('updated_at', L('Updated At'))->listable(false); }); goto T_Mky; T_Mky: foreach (QuestionCatUtil::all() as $REa1I) { $cv5kq->scopeFilter($REa1I['id'], $REa1I['title'], function (ScopeFilter $qM7YH) use($REa1I) { $qM7YH->where('catId', $REa1I['id']); }); } goto fF2ug; qCFvC: } }