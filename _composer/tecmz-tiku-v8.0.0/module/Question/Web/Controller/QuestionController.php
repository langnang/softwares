<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Question\Web\Controller; use Illuminate\Support\Facades\View; use ModStart\Core\Input\InputPackage; use ModStart\Core\Input\Request; use ModStart\Core\Input\Response; use ModStart\Module\ModuleBaseController; use Module\Member\Auth\MemberUser; use Module\Question\Util\QuestionUtil; class QuestionController extends ModuleBaseController { private $api; public function __construct() { $this->api = app(\Module\Question\Api\Controller\QuestionController::class); } public function index() { if (!QuestionUtil::isEnable()) { return QuestionUtil::disabledResponse(); } return $this->view('question.index'); } public function views($wKi71) { goto y7jun; y7jun: if (!QuestionUtil::isEnable()) { return QuestionUtil::disabledResponse(); } goto TxWNg; TxWNg: InputPackage::mergeToInput('alias', $wKi71); goto BocqT; BocqT: $GeXSC = Response::tryGetData($this->api->get()); goto BiINa; BiINa: return $this->view('question.view', $GeXSC); goto vfhz5; vfhz5: } public function answer($wKi71) { goto SLLeC; ao7zn: if (!MemberUser::id()) { return Response::json(-1, '登录后才能查看答案', null, modstart_web_url('login') . '?redirect=' . urlencode(Request::headerGet('Referer'))); } goto rhFUz; rhFUz: $BEdDh = $this->api->answer(); goto qLryq; SLLeC: if (!QuestionUtil::isEnable()) { return QuestionUtil::disabledResponse(); } goto bG4iF; qLryq: if (Response::isError($BEdDh)) { return Response::sendFromGenerate($BEdDh); } goto smTFg; kMLW4: return Response::json(0, 'ok', array('html' => View::make('module::Question.View.public.questionPart.answer', $GeXSC)->render())); goto dtAj3; smTFg: $GeXSC = $BEdDh['data']; goto kMLW4; bG4iF: InputPackage::mergeToInput('alias', $wKi71); goto ao7zn; dtAj3: } public function search() { $hlYz_ = Response::tryGetData($this->api->lists()); return $this->view('question.search', $hlYz_); } }