<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Utils; class RsaEncrypt { protected $key; public function __construct($Mlv3V) { $this->key = $Mlv3V; } public function setKey($Mlv3V) { $this->key = $Mlv3V; } public function encrypt($GeXSC) { goto vacIc; EcVju: $GtgYE = base64_encode($GtgYE); goto CvkpI; LlZJI: $z4jAX = openssl_get_privatekey($this->key); goto d6o6q; d6o6q: if (empty($z4jAX)) { throw new \Exception('您使用的私钥格式错误，请检查RSA私钥配置'); } goto uJJ2A; vacIc: if ($this->key === false) { return ''; } goto LlZJI; uJJ2A: openssl_sign($GeXSC, $GtgYE, $z4jAX); goto mLAGD; CvkpI: return $GtgYE; goto cfB7B; mLAGD: openssl_free_key($z4jAX); goto EcVju; cfB7B: } public function decrypt($KqFED) { goto pEgLU; tzQDq: return $hlYz_; goto EwPBS; pEgLU: if ($this->key === false) { return ''; } goto Cv32c; mNNoD: $hlYz_ = ''; goto Gc0aW; mivVn: $KqFED = base64_decode($KqFED); goto mNNoD; UekHL: if (empty($z4jAX)) { throw new \Exception('您使用的私钥格式错误，请检查RSA私钥配置'); } goto mivVn; Gc0aW: for ($l3Jim = 0; $l3Jim < strlen($KqFED) / 128; $l3Jim++) { $GeXSC = substr($KqFED, $l3Jim * 128, 128); openssl_private_decrypt($GeXSC, $fP4QT, $z4jAX); $hlYz_ .= $fP4QT; } goto GJAZi; Cv32c: $z4jAX = openssl_get_privatekey($this->key); goto UekHL; GJAZi: openssl_free_key($z4jAX); goto tzQDq; EwPBS: } public function rsaVerify($GeXSC, $GtgYE) { goto lpZ3z; lpZ3z: $z4jAX = openssl_get_publickey($this->key); goto UBtuk; ho2ND: return $hlYz_; goto XoZrp; vXxcj: openssl_free_key($z4jAX); goto ho2ND; QCjnm: $hlYz_ = (bool) openssl_verify($GeXSC, base64_decode($GtgYE), $z4jAX); goto vXxcj; UBtuk: if (empty($z4jAX)) { throw new \Exception('支付宝RSA公钥错误。请检查公钥文件格式是否正确'); } goto QCjnm; XoZrp: } }