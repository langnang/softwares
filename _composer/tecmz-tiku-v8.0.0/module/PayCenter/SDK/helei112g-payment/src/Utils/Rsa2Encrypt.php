<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Utils; class Rsa2Encrypt { protected $key; public function __construct($Mlv3V) { $this->key = $Mlv3V; } public function setKey($Mlv3V) { $this->key = $Mlv3V; } public function encrypt($GeXSC) { goto vQ8Gi; Gn7sk: openssl_free_key($z4jAX); goto YaypD; kuJn1: openssl_sign($GeXSC, $GtgYE, $z4jAX, OPENSSL_ALGO_SHA256); goto Gn7sk; DgJZ5: return $GtgYE; goto Wm6xY; YaypD: $GtgYE = base64_encode($GtgYE); goto DgJZ5; NrlYm: if (empty($z4jAX)) { throw new \Exception('您使用的私钥格式错误，请检查RSA私钥配置'); } goto kuJn1; bk6UJ: $z4jAX = openssl_get_privatekey($this->key); goto NrlYm; vQ8Gi: if ($this->key === false) { return ''; } goto bk6UJ; Wm6xY: } public function decrypt($KqFED) { goto K53Ts; K53Ts: if ($this->key === false) { return ''; } goto bfMYn; OwLGn: foreach ($DtU_M as $KtocX => $AwxG7) { if (!openssl_private_decrypt($AwxG7, $qdK8W, $z4jAX)) { echo '<br/>' . openssl_error_string() . '<br/>'; } $Lv50i .= $qdK8W; } goto T3nBC; bfMYn: $z4jAX = openssl_get_privatekey($this->key); goto f3Rqa; s8lbr: $qdK8W = ''; goto OwLGn; UZo_Z: $DtU_M = base64_decode($KqFED); goto ipzNk; T3nBC: openssl_free_key($z4jAX); goto w7bj6; ipzNk: $Lv50i = ''; goto s8lbr; f3Rqa: if (empty($z4jAX)) { throw new \Exception('您使用的私钥格式错误，请检查RSA私钥配置'); } goto UZo_Z; w7bj6: return $Lv50i; goto jenxf; jenxf: } public function rsaVerify($GeXSC, $GtgYE) { goto Rtv6k; wPMj5: return $hlYz_; goto oU4yl; dlFnB: if (empty($z4jAX)) { throw new \Exception('支付宝RSA公钥错误。请检查公钥文件格式是否正确'); } goto vRRFL; Rtv6k: $z4jAX = openssl_get_publickey($this->key); goto dlFnB; r6uEM: openssl_free_key($z4jAX); goto wPMj5; vRRFL: $hlYz_ = (bool) openssl_verify($GeXSC, base64_decode($GtgYE), $z4jAX, OPENSSL_ALGO_SHA256); goto r6uEM; oU4yl: } }