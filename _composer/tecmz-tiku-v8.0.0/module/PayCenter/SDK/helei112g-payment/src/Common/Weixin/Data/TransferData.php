<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Common\Weixin\Data; use Payment\Common\PayException; use Payment\Utils\ArrayUtil; class TransferData extends WxBaseData { protected function buildData() { $this->retData = array('mch_appid' => $this->appId, 'mchid' => $this->mchId, 'device_info' => $this->terminal_id, 'nonce_str' => $this->nonceStr, 'partner_trade_no' => $this->trans_no, 'openid' => $this->openid, 'check_name' => $this->check_name, 're_user_name' => $this->payer_real_name, 'amount' => $this->amount, 'desc' => $this->desc, 'spbill_create_ip' => $this->client_ip); $this->retData = ArrayUtil::paraFilter($this->retData); } protected function checkDataParam() { goto O1OWg; c6LTn: $iAqUg = $this->check_name; goto BY1tO; PLI1B: if (empty($F3tdn) || $F3tdn < 0) { throw new PayException('转账金额错误'); } goto OMJlY; zPYgA: if (empty($jDVRk)) { throw new PayException('商户订单号，需保持唯一性'); } goto DiRMI; O1OWg: $qFGW9 = $this->openid; goto olOFX; Hpu_E: $this->amount = bcmul($F3tdn, 100, 0); goto PLI1B; abAe0: $F3tdn = $this->amount; goto ubW3U; BY1tO: $R2bES = $this->payer_real_name; goto abAe0; olOFX: $jDVRk = $this->trans_no; goto c6LTn; Ey_Qn: if (empty($qFGW9)) { throw new PayException('商户appid下，某用户的openid 必须传入'); } goto zPYgA; ubW3U: $bu1HO = $this->client_ip; goto Ey_Qn; DiRMI: if ($iAqUg !== 'NO_CHECK' && empty($R2bES)) { throw new PayException('请传入收款人真实姓名'); } goto Hpu_E; OMJlY: if (empty($bu1HO)) { $this->client_ip = isset($_SERVER['REMOTE_ADDR']) ? $_SERVER['REMOTE_ADDR'] : '127.0.0.1'; } goto SQGbx; SQGbx: } }