<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Common\Weixin\Data; use Payment\Common\PayException; use Payment\Utils\ArrayUtil; class RedData extends WxBaseData { protected function buildData() { $this->retData = array('act_name' => $this->act_name, 'client_ip' => $this->client_ip, 'mch_billno' => $this->mch_billno, 'mch_id' => $this->mchId, 'nonce_str' => $this->nonceStr, 're_openid' => $this->re_openid, 'remark' => $this->remark, 'scene_id' => $this->scene_id, 'send_name' => $this->send_name, 'total_amount' => $this->total_amount, 'total_num' => $this->total_num ? $this->total_num : 1, 'wishing' => $this->wishing, 'wxappid' => $this->appId, 'msgappid' => $this->sub_appid, 'sub_mch_id' => $this->sub_mch_id); $this->retData = ArrayUtil::paraFilter($this->retData); } protected function checkDataParam() { goto PhtSF; uZ2yA: if (empty($nA91L)) { throw new PayException('请设置单号 mch_billno'); } goto BC2PI; bJtxr: $ZI4gJ = $this->total_amount; goto jdS4m; uDAGr: $tfVOF = $this->appCertPem; goto yRNjw; B9pVF: if (empty($ACXwI)) { throw new PayException('请设置接收者 openID'); } goto Weshm; zUOeq: if (empty($tfVOF)) { throw new PayException('红包接口，必须提供 apiclient_cert.pem 证书'); } goto cCs3f; Diz0D: $gKxSS = $this->act_name; goto zM0Sf; itfoQ: $hz2B2 = $this->wishing; goto Diz0D; BC2PI: if (empty($zyKkF)) { throw new PayException('请设置发送名称 send_name'); } goto B9pVF; cCs3f: if (empty($FOaqO)) { throw new PayException('红包接口，必须提供 apiclient_key.pem 证书'); } goto tI00L; zn3dx: if (empty($gKxSS)) { throw new PayException('请设置活动名称'); } goto mkLrM; mkLrM: if (empty($DfuA7)) { throw new PayException('请设置备注信息'); } goto PHXYN; Weshm: if (empty($hz2B2)) { throw new PayException('请设置祝福语'); } goto zn3dx; PhtSF: $nA91L = $this->mch_billno; goto lk229; PHXYN: $this->total_amount = bcmul($ZI4gJ, 100, 0); goto w6SDl; lk229: $zyKkF = $this->send_name; goto p6FmG; jdS4m: $tpzcc = $this->send_listid; goto uZ2yA; QQVHk: if (empty($tpzcc) && empty($nA91L)) { throw new PayException('必须提供微信交易号或商户网站唯一订单号。建议使用微信交易号'); } goto uDAGr; w6SDl: if (empty($ZI4gJ) || $ZI4gJ < 1) { throw new PayException('转账金额错误'); } goto QQVHk; zM0Sf: $DfuA7 = $this->remark; goto bJtxr; yRNjw: $FOaqO = $this->appKeyPem; goto zUOeq; p6FmG: $ACXwI = $this->re_openid; goto itfoQ; tI00L: } }