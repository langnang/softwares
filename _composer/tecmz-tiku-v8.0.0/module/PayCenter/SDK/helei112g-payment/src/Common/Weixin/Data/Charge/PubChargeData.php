<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Common\Weixin\Data\Charge; use Payment\Common\PayException; use Payment\Utils\ArrayUtil; class PubChargeData extends ChargeBaseData { protected function checkDataParam() { goto FNi0f; jO2jE: $yB8Gl = $this->sub_openid; goto f_8fw; aMkTw: if (empty($Fe53m)) { throw new PayException('用户在商户appid下的唯一标识,公众号支付,必须设置该参数.'); } goto SAdAD; YLjq7: $Fe53m = $this->openid; goto aMkTw; SAdAD: $pd2MX = $this->sub_mch_id; goto jO2jE; FNi0f: parent::checkDataParam(); goto YLjq7; f_8fw: if ($pd2MX && empty($yB8Gl)) { throw new PayException('公众号的服务商模式，必须提供 sub_openid 参数.'); } goto lobiF; lobiF: } protected function buildData() { goto A1bUP; U0hhU: $ja3LF = array('appid' => trim($this->appId), 'mch_id' => trim($this->mchId), 'device_info' => $this->terminal_id, 'nonce_str' => $this->nonceStr, 'sign_type' => $this->signType, 'body' => trim($this->subject), 'attach' => trim($this->return_param), 'out_trade_no' => trim($this->order_no), 'fee_type' => $this->feeType, 'total_fee' => $this->amount, 'spbill_create_ip' => trim($this->client_ip), 'time_start' => $this->timeStart, 'time_expire' => $this->timeout_express, 'notify_url' => $this->notifyUrl, 'trade_type' => $this->tradeType, 'limit_pay' => $this->limitPay, 'openid' => $this->openid, 'scene_info' => $svIJz ? json_encode($svIJz, JSON_UNESCAPED_UNICODE) : '', 'sub_appid' => $this->sub_appid, 'sub_mch_id' => $this->sub_mch_id, 'sub_openid' => $this->sub_openid); goto I8NwW; PYMMQ: if ($kkerk && is_array($kkerk)) { $svIJz['store_info'] = $kkerk; } goto U0hhU; I8NwW: $this->retData = ArrayUtil::paraFilter($ja3LF); goto o3bXL; Gpqjs: $svIJz = array(); goto PYMMQ; A1bUP: $kkerk = $this->scene_info; goto Gpqjs; o3bXL: } }