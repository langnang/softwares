<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Api\Controller; use ModStart\Core\Exception\BizException; use ModStart\Core\Input\InputPackage; use ModStart\Core\Input\Response; use ModStart\Core\Util\CRUDUtil; use ModStart\Module\ModuleBaseController; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; use Module\Member\Util\MemberAddressUtil; class MemberAddressController extends ModuleBaseController implements MemberLoginCheck { public function all() { return Response::generateSuccessData(MemberAddressUtil::listUserAddresses(MemberUser::id())); } public function getDefault() { return Response::generateSuccessData(MemberAddressUtil::getDefault(MemberUser::id())); } public function edit() { goto Q6IE_; xESva: BizException::throwsIfEmpty('地址为空', $WAiaw['area']); goto kDkLm; FAEF5: $WAiaw['name'] = $nIp2z->getTrimString('name'); goto W01n8; LYjbR: $WAiaw = array(); goto FAEF5; W01n8: $WAiaw['phone'] = $nIp2z->getTrimString('phone'); goto KKpYk; kDkLm: BizException::throwsIfEmpty('详细地址为空', $WAiaw['detail']); goto R5W2x; lnVMl: $WAiaw['isDefault'] = $nIp2z->getBoolean('isDefault'); goto VfEop; uKS65: if ($wQ1uv) { $NHARU = MemberAddressUtil::getUserAddress(MemberUser::id(), $wQ1uv); BizException::throwsIfEmpty('地址不存在', $NHARU); } goto LYjbR; FGdaz: if ($NHARU) { MemberAddressUtil::update($NHARU['id'], $WAiaw); } else { $WAiaw['memberUserId'] = MemberUser::id(); MemberAddressUtil::insert($WAiaw); } goto U8PpP; mV3uR: BizException::throwsIfEmpty('手机为空', $WAiaw['phone']); goto xESva; U8PpP: return Response::generateSuccess(); goto mflIa; Q6IE_: $nIp2z = InputPackage::buildFromInput(); goto ZEHq0; R5W2x: if ($WAiaw['isDefault']) { MemberAddressUtil::resetDefault(MemberUser::id()); } goto FGdaz; ZEHq0: $wQ1uv = $nIp2z->getInteger('id'); goto QIdR8; VfEop: BizException::throwsIfEmpty('姓名为空', $WAiaw['name']); goto mV3uR; QIdR8: $NHARU = null; goto uKS65; RSRE5: $WAiaw['detail'] = $nIp2z->getTrimString('detail'); goto lnVMl; KKpYk: $WAiaw['area'] = $nIp2z->getTrimString('area'); goto RSRE5; mflIa: } public function delete() { goto TsHEY; f9HHm: MemberAddressUtil::delete($NHARU['id']); goto xH_Br; xH_Br: return Response::generateSuccess(); goto dm6co; TsHEY: $nIp2z = InputPackage::buildFromInput(); goto meV6R; bV8kx: BizException::throwsIfEmpty('地址不存在', $NHARU); goto f9HHm; meV6R: $wQ1uv = $nIp2z->getInteger('id'); goto MFEy0; MFEy0: $NHARU = MemberAddressUtil::getUserAddress(MemberUser::id(), $wQ1uv); goto bV8kx; dm6co: } }