<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Util; use ModStart\Core\Dao\ModelUtil; use Module\Vendor\Cache\CacheUtil; class MemberGroupUtil { public static function all() { return CacheUtil::rememberForever('MemberGroupList', function () { return ModelUtil::all('member_group', array(), array('*'), array('id', 'asc')); }); } public static function mapIdTitle() { return array_build(self::all(), function ($hBBDL, $p4EDY) { return array($p4EDY['id'], $p4EDY['title']); }); } public static function defaultGroup() { foreach (self::all() as $ik1Tw) { if ($ik1Tw['isDefault']) { return $ik1Tw; } } return null; } public static function defaultGroupId() { $ik1Tw = self::defaultGroup(); return $ik1Tw ? $ik1Tw['id'] : 0; } public static function map() { return CacheUtil::rememberForever('MemberGroupMap', function () { return array_build(self::all(), function ($hBBDL, $p4EDY) { return array($p4EDY['id'], $p4EDY); }); }); } public static function get($newWa) { goto D2WqQ; YUNoa: if (null === $iMATK) { $iMATK = self::map(); } goto ZQddr; D2WqQ: static $iMATK = null; goto YUNoa; jDP5O: if (isset($iMATK[$newWa])) { return $iMATK[$newWa]; } goto Niwzd; Niwzd: return null; goto JPEmQ; ZQddr: if (empty($newWa)) { foreach ($iMATK as $qlKQK) { if ($qlKQK['isDefault']) { return $qlKQK; } } return null; } goto jDP5O; JPEmQ: } public static function getMemberGroup($OYXQL) { if (empty($OYXQL)) { return null; } return self::get($OYXQL['groupId']); } public static function clearCache() { CacheUtil::forget('MemberGroupList'); CacheUtil::forget('MemberGroupMap'); } }