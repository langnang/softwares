<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment; use Payment\Charge\Ali\AliAppCharge; use Payment\Charge\Ali\AliBarCharge; use Payment\Charge\Ali\AliWapCharge; use Payment\Charge\Ali\AliWebCharge; use Payment\Charge\Ali\AliQrCharge; use Payment\Charge\Cmb\CmbCharge; use Payment\Charge\Wx\WxAppCharge; use Payment\Charge\Wx\WxBarCharge; use Payment\Charge\Wx\WxPubCharge; use Payment\Charge\Wx\WxQrCharge; use Payment\Charge\Wx\WxWapCharge; use Payment\Common\BaseStrategy; use Payment\Common\PayException; class ChargeContext { protected $channel; public function initCharge($ghw00, array $qc0K6) { try { switch ($ghw00) { case Config::ALI_CHANNEL_WAP: $this->channel = new AliWapCharge($qc0K6); break; case Config::ALI_CHANNEL_APP: $this->channel = new AliAppCharge($qc0K6); break; case Config::ALI_CHANNEL_WEB: $this->channel = new AliWebCharge($qc0K6); break; case Config::ALI_CHANNEL_QR: $this->channel = new AliQrCharge($qc0K6); break; case Config::ALI_CHANNEL_BAR: $this->channel = new AliBarCharge($qc0K6); break; case Config::WX_CHANNEL_APP: $this->channel = new WxAppCharge($qc0K6); break; case Config::WX_CHANNEL_LITE: case Config::WX_CHANNEL_PUB: $this->channel = new WxPubCharge($qc0K6); break; case Config::WX_CHANNEL_WAP: $this->channel = new WxWapCharge($qc0K6); break; case Config::WX_CHANNEL_QR: $this->channel = new WxQrCharge($qc0K6); break; case Config::WX_CHANNEL_BAR: $this->channel = new WxBarCharge($qc0K6); break; case Config::CMB_CHANNEL_WAP: case Config::CMB_CHANNEL_APP: $this->channel = new CmbCharge($qc0K6); break; case Config::CCB_CHANNEL_WEB: $this->channel = new CcbWebCharge($qc0K6); break; default: throw new PayException('当前仅支持：支付宝  微信 招商一网通 建设银行'); } } catch (PayException $knlzD) { throw $knlzD; } } public function charge(array $GeXSC) { if (!$this->channel instanceof BaseStrategy) { throw new PayException('请检查初始化是否正确'); } try { return $this->channel->handle($GeXSC); } catch (PayException $knlzD) { throw $knlzD; } } }