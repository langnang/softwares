<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Query\Cmb; use Payment\Common\Cmb\CmbBaseStrategy; use Payment\Common\Cmb\Data\Query\ChargeQueryData; use Payment\Common\CmbConfig; use Payment\Config; class CmbChargeQuery extends CmbBaseStrategy { public function getBuildDataClass() { goto qFCOg; wwxP_: return ChargeQueryData::class; goto TSHVr; qFCOg: $this->config->getewayUrl = 'https://payment.ebank.cmbchina.com/NetPayment/BaseHttp.dll?QuerySingleOrder'; goto Yd6kC; Yd6kC: if ($this->config->useSandbox) { $this->config->getewayUrl = 'http://121.15.180.66:801/NetPayment_dl/BaseHttp.dll?QuerySingleOrder'; } goto wwxP_; TSHVr: } protected function retData(array $BEdDh) { goto BMKtg; T6mua: $L2aCU = CmbConfig::REQ_FILED_NAME . '=' . $hBfCc; goto nt1H_; nt1H_: $BEdDh = $this->sendReq($L2aCU); goto oJTVs; SkMkj: $eypYa = array('is_success' => 'T', 'response' => array('amount' => $BEdDh['orderAmount'], 'channel' => Config::CMB_CHARGE, 'order_no' => $BEdDh['orderNo'], 'trade_state' => $this->getTradeStatus($BEdDh['orderStatus']), 'transaction_id' => $BEdDh['bankSerialNo'], 'time_end' => date('Y-m-d H:i:s', strtotime($BEdDh['settleDate'] . $BEdDh['settleTime'])), 'fee' => $BEdDh['fee'], 'time_start' => date('Y-m-d H:i:s', strtotime($BEdDh['bankDate'] . $BEdDh['bankTime'])), 'discount_fee' => $BEdDh['discountAmount'], 'card_type' => $BEdDh['cardType'], 'return_param' => $BEdDh['merchantPara'])); goto JosC3; JosC3: return $eypYa; goto PTG31; BMKtg: $hBfCc = json_encode($BEdDh, JSON_UNESCAPED_UNICODE); goto T6mua; oJTVs: if ($this->config->returnRaw) { $BEdDh['channel'] = Config::CMB_CHARGE; return $BEdDh; } goto SkMkj; PTG31: } }