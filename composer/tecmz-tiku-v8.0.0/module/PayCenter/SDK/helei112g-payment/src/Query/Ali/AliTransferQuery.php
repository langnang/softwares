<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Query\Ali; use Payment\Common\Ali\AliBaseStrategy; use Payment\Common\Ali\Data\Query\TransferQueryData; use Payment\Common\PayException; use Payment\Config; use Payment\Utils\ArrayUtil; class AliTransferQuery extends AliBaseStrategy { protected $method = 'alipay.fund.trans.order.query'; public function getBuildDataClass() { $this->config->method = $this->method; return TransferQueryData::class; } protected function retData(array $GeXSC) { goto v3dbD; Abu3h: return $this->createBackData($BEdDh); goto oW_lX; v3dbD: $sx3MN = parent::retData($GeXSC); goto K3ITO; BMdDe: if ($this->config->returnRaw) { $BEdDh['channel'] = Config::ALI_TRANSFER; return $BEdDh; } goto Abu3h; K3ITO: try { $BEdDh = $this->sendReq($sx3MN); } catch (PayException $knlzD) { throw $knlzD; } goto BMdDe; oW_lX: } protected function createBackData(array $GeXSC) { goto oOeg3; oOeg3: if ($GeXSC['code'] !== '10000') { return $eypYa = array('is_success' => 'F', 'error' => $GeXSC['sub_msg'], 'channel' => Config::ALI_TRANSFER); } goto j9DGZ; Kebmq: if (isset($GeXSC['error_code'])) { $eypYa['response']['error_code'] = ArrayUtil::get($GeXSC, 'error_code'); $eypYa['response']['fail_reason'] = ArrayUtil::get($GeXSC, 'fail_reason'); } goto zJm99; zJm99: return $eypYa; goto fWnPA; j9DGZ: $eypYa = array('is_success' => 'T', 'response' => array('transaction_id' => ArrayUtil::get($GeXSC, 'order_id'), 'status' => strtolower(ArrayUtil::get($GeXSC, 'status')), 'pay_date' => ArrayUtil::get($GeXSC, 'pay_date'), 'arrival_time_end' => ArrayUtil::get($GeXSC, 'arrival_time_end'), 'amount' => ArrayUtil::get($GeXSC, 'order_fee'), 'trans_no' => ArrayUtil::get($GeXSC, 'out_biz_no'), 'channel' => Config::ALI_TRANSFER)); goto Kebmq; fWnPA: } }