<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Common; use Payment\Config; use Payment\Utils\ArrayUtil; abstract class BaseData { protected $data; protected $retData; protected $channel; public function __construct(ConfigInterface $qc0K6, array $sx3MN) { goto LqssB; kTUSI: try { $this->checkDataParam(); } catch (PayException $knlzD) { throw $knlzD; } goto i10ti; LqssB: if ($qc0K6 instanceof WxConfig) { $this->channel = Config::WECHAT_PAY; } elseif ($qc0K6 instanceof AliConfig) { $this->channel = Config::ALI_PAY; } elseif ($qc0K6 instanceof CmbConfig) { $this->channel = Config::CMB_PAY; } elseif ($qc0K6 instanceof CcbConfig) { $this->channel = Config::CCB_PAY; } goto iwW7H; iwW7H: $this->data = array_merge($qc0K6->toArray(), $sx3MN); goto kTUSI; i10ti: } public function __get($AfXAM) { if (isset($this->data[$AfXAM])) { return $this->data[$AfXAM]; } return null; } public function __set($AfXAM, $WZC9G) { $this->data[$AfXAM] = $WZC9G; } public function setSign() { goto OUK_2; Pn8mq: $IRvxP = ArrayUtil::createLinkstring($vjyaQ); goto iTHrN; fDhuE: if ($this->channel === Config::CMB_PAY) { $GeXSC = $this->retData['reqData']; } else { $GeXSC = $this->retData; } goto LASU3; LASU3: $vjyaQ = ArrayUtil::removeKeys($GeXSC, array('sign')); goto uHpHY; OUK_2: $this->buildData(); goto fDhuE; uHpHY: $vjyaQ = ArrayUtil::arraySort($vjyaQ); goto Pn8mq; iTHrN: $this->retData['sign'] = $this->makeSign($IRvxP); goto zHEBI; zHEBI: } public function getData() { return $this->retData; } protected abstract function makeSign($IRvxP); protected abstract function buildData(); protected abstract function checkDataParam(); }