<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Common; use Payment\Utils\ArrayUtil; use Payment\Utils\StrUtil; final class AliConfig extends ConfigInterface { public $getewayUrl; public $appId; public $method; public $format = 'JSON'; public $returnUrl; public $charset = 'UTF-8'; public $timestamp; public $version = '1.0'; public $rsaPrivateKey; public $rsaAliPubKey; protected function initConfig(array $qc0K6) { goto DxMQC; w3dmL: $this->timestamp = date('Y-m-d H:i:s', time()); goto MUFz4; Ig0S2: if (key_exists('ali_public_key', $qc0K6) && !empty($qc0K6['ali_public_key'])) { $this->rsaAliPubKey = StrUtil::getRsaKeyValue($qc0K6['ali_public_key'], 'public'); } else { throw new PayException('请提供支付宝对应的rsa公钥'); } goto e96Cl; e96Cl: if (empty($this->rsaAliPubKey)) { throw new PayException('支付宝公钥生成错误，如果你使用的是文件方式配置，建议修改为字符串配置'); } goto hSIqp; nRhZW: if (key_exists('sign_type', $qc0K6) && in_array($qc0K6['sign_type'], array('RSA', 'RSA2'))) { $this->signType = $qc0K6['sign_type']; } else { throw new PayException('目前支付宝仅支持RSA2和RSA，推荐使用RSA2'); } goto Ig0S2; B0U4I: if (isset($qc0K6['use_sandbox']) && $qc0K6['use_sandbox'] === true) { $this->getewayUrl = 'https://openapi.alipaydev.com/gateway.do'; } else { $this->useSandbox = false; } goto i4Pru; phLBT: if (empty($this->rsaPrivateKey)) { throw new PayException('支付宝rsa私钥生成错误，如果你使用的是文件方式配置，建议修改为字符串配置'); } goto w3dmL; DxMQC: $qc0K6 = ArrayUtil::paraFilter($qc0K6); goto jGpp7; hnECq: if (key_exists('notify_url', $qc0K6)) { $this->notifyUrl = $qc0K6['notify_url']; } goto wKW1k; hSIqp: if (key_exists('rsa_private_key', $qc0K6) && !empty($qc0K6['rsa_private_key'])) { $this->rsaPrivateKey = StrUtil::getRsaKeyValue($qc0K6['rsa_private_key'], 'private'); } else { throw new PayException('请提供商户的rsa私钥文件'); } goto phLBT; wKW1k: if (key_exists('return_url', $qc0K6)) { $this->returnUrl = $qc0K6['return_url']; } goto nRhZW; NlXLe: if (key_exists('return_raw', $qc0K6)) { $this->returnRaw = filter_var($qc0K6['return_raw'], FILTER_VALIDATE_BOOLEAN); } goto n1hAB; jGpp7: $this->getewayUrl = 'https://openapi.alipay.com/gateway.do'; goto B0U4I; MUFz4: if (key_exists('limit_pay', $qc0K6) && is_array($qc0K6['limit_pay'])) { $this->limitPay = implode(',', $qc0K6['limit_pay']); } goto NlXLe; i4Pru: if (key_exists('app_id', $qc0K6) && is_numeric($qc0K6['app_id'])) { $this->appId = $qc0K6['app_id']; } else { throw new PayException('支付宝应用ID错误，请检查'); } goto hnECq; n1hAB: } }