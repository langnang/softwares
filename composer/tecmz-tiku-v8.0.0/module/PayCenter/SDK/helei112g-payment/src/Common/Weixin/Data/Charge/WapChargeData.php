<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Payment\Common\Weixin\Data\Charge; use Payment\Common\PayException; use Payment\Utils\ArrayUtil; class WapChargeData extends ChargeBaseData { protected function checkDataParam() { goto A6p_l; rblnN: if (!is_array($kkerk) || empty($kkerk)) { throw new PayException('微信 H5 支付，必须提供该参数'); } goto al8GX; Xm5v8: $kkerk = $this->scene_info; goto rblnN; A6p_l: parent::checkDataParam(); goto Xm5v8; al8GX: } protected function buildData() { goto w6hH8; Lzp02: if ($kkerk && is_array($kkerk)) { $svIJz['h5_info'] = $kkerk; } goto TQNfc; w6hH8: $kkerk = $this->scene_info; goto HpXmE; HpXmE: $svIJz = array(); goto Lzp02; TQNfc: $ja3LF = array('appid' => trim($this->appId), 'mch_id' => trim($this->mchId), 'device_info' => $this->terminal_id, 'nonce_str' => $this->nonceStr, 'sign_type' => $this->signType, 'body' => trim($this->subject), 'attach' => trim($this->return_param), 'out_trade_no' => trim($this->order_no), 'fee_type' => $this->feeType, 'total_fee' => $this->amount, 'spbill_create_ip' => trim($this->client_ip), 'time_start' => $this->timeStart, 'time_expire' => $this->timeout_express, 'notify_url' => $this->notifyUrl, 'trade_type' => $this->tradeType, 'limit_pay' => $this->limitPay, 'openid' => $this->openid, 'scene_info' => $svIJz ? json_encode($svIJz, JSON_UNESCAPED_UNICODE) : '', 'sub_appid' => $this->sub_appid, 'sub_mch_id' => $this->sub_mch_id, 'sub_openid' => $this->sub_openid); goto wX8Xt; wX8Xt: $this->retData = ArrayUtil::paraFilter($ja3LF); goto qWd5j; qWd5j: } }