<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Api\Controller; use ModStart\Core\Exception\BizException; use ModStart\Core\Input\InputPackage; use ModStart\Core\Input\Response; use ModStart\Core\Util\CRUDUtil; use ModStart\Module\ModuleBaseController; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; use Module\Member\Util\MemberAddressUtil; class MemberAddressController extends ModuleBaseController implements MemberLoginCheck { public function all() { return Response::generateSuccessData(MemberAddressUtil::listUserAddresses(MemberUser::id())); } public function getDefault() { return Response::generateSuccessData(MemberAddressUtil::getDefault(MemberUser::id())); } public function edit() { goto dxGfv; H1_kY: BizException::throwsIfEmpty('地址为空', $GeXSC['area']); goto kEEWt; EwhCG: $GeXSC['detail'] = $bz1sB->getTrimString('detail'); goto vwbrH; xNBZc: BizException::throwsIfEmpty('手机为空', $GeXSC['phone']); goto H1_kY; dxGfv: $bz1sB = InputPackage::buildFromInput(); goto oq9pL; y1ICT: $GeXSC['name'] = $bz1sB->getTrimString('name'); goto sXp7m; kEEWt: BizException::throwsIfEmpty('详细地址为空', $GeXSC['detail']); goto n8dzF; n6ocv: if ($wa91I) { $cWs18 = MemberAddressUtil::getUserAddress(MemberUser::id(), $wa91I); BizException::throwsIfEmpty('地址不存在', $cWs18); } goto bPT0_; n8dzF: if ($GeXSC['isDefault']) { MemberAddressUtil::resetDefault(MemberUser::id()); } goto m3G3_; vwbrH: $GeXSC['isDefault'] = $bz1sB->getBoolean('isDefault'); goto y0rhv; y0rhv: BizException::throwsIfEmpty('姓名为空', $GeXSC['name']); goto xNBZc; oq9pL: $wa91I = $bz1sB->getInteger('id'); goto h4DeD; bPT0_: $GeXSC = array(); goto y1ICT; sXp7m: $GeXSC['phone'] = $bz1sB->getTrimString('phone'); goto KngIh; m3G3_: if ($cWs18) { MemberAddressUtil::update($cWs18['id'], $GeXSC); } else { $GeXSC['memberUserId'] = MemberUser::id(); MemberAddressUtil::insert($GeXSC); } goto uDRIU; uDRIU: return Response::generateSuccess(); goto c8EsH; KngIh: $GeXSC['area'] = $bz1sB->getTrimString('area'); goto EwhCG; h4DeD: $cWs18 = null; goto n6ocv; c8EsH: } public function delete() { goto Yw2Ws; Yw2Ws: $bz1sB = InputPackage::buildFromInput(); goto nhCRC; nhCRC: $wa91I = $bz1sB->getInteger('id'); goto sdPzs; UVBCA: return Response::generateSuccess(); goto FGi4H; bKRNo: BizException::throwsIfEmpty('地址不存在', $cWs18); goto qfrC2; qfrC2: MemberAddressUtil::delete($cWs18['id']); goto UVBCA; sdPzs: $cWs18 = MemberAddressUtil::getUserAddress(MemberUser::id(), $wa91I); goto bKRNo; FGi4H: } }