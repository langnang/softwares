<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Api\Controller; use ModStart\Core\Input\InputPackage; use ModStart\Core\Input\Response; use ModStart\Core\Util\CRUDUtil; use ModStart\Module\ModuleBaseController; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; use Module\Member\Util\MemberMessageUtil; class MemberMessageController extends ModuleBaseController implements MemberLoginCheck { public function paginate() { goto pri0F; JPY5t: $BfEFC = MemberMessageUtil::paginate(MemberUser::id(), $gETpv, $Wo30p, $InfBU); goto qCfF9; ZejTf: $gETpv = $bz1sB->getInteger('page'); goto zsndY; Js1L7: if (!empty($UIWVa['status'])) { $InfBU['search'][] = array('status' => array('equal' => intval($UIWVa['status']))); } goto JPY5t; cMG4O: $UIWVa = $bz1sB->getJson('search'); goto Js1L7; qCfF9: return Response::generateSuccessPaginateData($gETpv, $Wo30p, $BfEFC['records'], $BfEFC['total']); goto iy1z_; pri0F: $bz1sB = InputPackage::buildFromInput(); goto ZejTf; zsndY: $Wo30p = 10; goto Igs0o; Igs0o: $InfBU = array('search' => array(), 'order' => array('id', 'desc')); goto cMG4O; iy1z_: } public function delete() { MemberMessageUtil::delete(MemberUser::id(), CRUDUtil::ids()); return Response::generateSuccessData(array('unreadMessageCount' => MemberMessageUtil::getUnreadMessageCount(MemberUser::id()))); } public function read() { MemberMessageUtil::updateRead(MemberUser::id(), CRUDUtil::ids()); return Response::generateSuccessData(array('unreadMessageCount' => MemberMessageUtil::getUnreadMessageCount(MemberUser::id()))); } public function readAll() { MemberMessageUtil::updateReadAll(MemberUser::id()); return Response::generateSuccess(); } public function deleteAll() { MemberMessageUtil::deleteAll(MemberUser::id()); return Response::generateSuccess(); } }