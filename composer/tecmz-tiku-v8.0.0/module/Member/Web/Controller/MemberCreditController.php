<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Web\Controller; use Illuminate\Support\Facades\View; use ModStart\App\Web\Layout\WebPage; use ModStart\Core\Input\Request; use ModStart\Field\AbstractField; use ModStart\Field\AutoRenderedFieldValue; use ModStart\Grid\Grid; use ModStart\Module\ModuleBaseController; use ModStart\Module\ModuleManager; use ModStart\Repository\Filter\RepositoryFilter; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; class MemberCreditController extends ModuleBaseController implements MemberLoginCheck { private $api; public function __construct() { goto kresL; h7JRe: $this->api = app(\Module\Member\Api\Controller\MemberCreditController::class); goto GLOvk; jWClf: View::share('_viewMemberFrame', $this->viewMemberFrame); goto h7JRe; kresL: list($this->viewMemberFrame, $GmKGX) = $this->viewPaths('member.frame'); goto jWClf; GLOvk: } public function index(WebPage $gETpv) { goto E7pcq; E7pcq: $rWlsS = Grid::make('member_credit_log'); goto wi80c; CREpI: list($Mi0Iq, $GmKGX) = $this->viewPaths('memberCredit.index'); goto Lm25V; Aktic: $rWlsS->useSimple(function (AbstractField $QGYmu, $REa1I, $x1Lvn) { return AutoRenderedFieldValue::makeView('module::Member.View.pc.memberCredit.item', array('item' => $REa1I)); }); goto tfa8e; rQtXS: $rWlsS->disableCUD()->disableItemOperate(); goto Aktic; s9rgF: return $gETpv->view($Mi0Iq)->body($rWlsS); goto pnlXi; Lm25V: $gETpv->pageTitle('我的' . ModuleManager::getModuleConfig('Member', 'creditName', '积分')); goto s9rgF; wi80c: $rWlsS->repositoryFilter(function (RepositoryFilter $qM7YH) { $qM7YH->where(array('memberUserId' => MemberUser::id())); }); goto rQtXS; tfa8e: if (Request::isPost()) { return $rWlsS->request(); } goto CREpI; pnlXi: } }