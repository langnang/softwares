(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brick-module-pay_center-pay"],{"013c":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("c975"),e("a9e3"),e("ac1f"),e("5319"),e("acd8");var i={type:"scrolldone",target:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},currentTarget:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},detail:{}},o={props:{backgroundTextStyle:{type:String,default:"dark",validator:function(t){return-1!==["dark","light"].indexOf(t)}},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created:function(){var t=this,a=getCurrentPages()[0];this.$pageVm=a.$vm||a,uni.onWindowResize((function(a){t.$emit("resize",a)})),this.$pageVm.$on("hook:onPageScroll",(function(a){t.$emit("scroll",a)})),this.$watch("backgroundTextStyle",(function(){t.setBackgroundTextStyle()})),this.$watch((function(){return[t.rootFontSize,t.pageStyle]}),(function(){t.setPageMeta()})),this.$watch((function(){return[t.backgroundColor,t.backgroundColorTop,t.backgroundColorBottom]}),(function(){t.setBackgroundColor()})),this.$watch((function(){return[t.scrollTop,t.scrollDuration]}),(function(){t.pageScrollTo()}))},beforeMount:function(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle(),this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh:function(t,a){t.setStyle({pullToRefresh:{support:a,style:"Android"===plus.os.name?"circle":"default"}})},setPageMeta:function(){uni.setPageMeta({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle:function(){},setBackgroundColor:function(){},pageScrollTo:function(){var t=this,a=String(this.scrollTop);if(-1!==a.indexOf("rpx")&&(a=uni.upx2px(a.replace("rpx",""))),a=parseFloat(a),!isNaN(a)){var e=function e(o){o.scrollTop===a&&(t.$pageVm.$off("hook:onPageScroll",e),t.$emit("scrolldone",i))};uni.pageScrollTo({scrollTop:a,duration:this.scrollDuration,success:function(){t.$pageVm.$on("hook:onPageScroll",e)}})}}}};a.default=o},"0429":function(t,a,e){var i=e("4bad");a=i(!1),a.push([t.i,'[data-v-6a32b030]:root,\nuni-page-body[data-v-6a32b030]{--color-primary:var(--theme-color-primary,#698af4);--color-primary-light:var(--theme-color-primary-light,#819df6);--color-primary-dark:var(--theme-color-primary-dark,#5177f2);--color-success:var(--theme-color-success,#28a745);--color-success-dark:var(--theme-color-success-dark,#1e7e34);--color-warning:var(--theme-color-warning,#fd7e14);--color-warning-dark:var(--theme-color-warning-dark,#dc6502);--color-danger:var(--theme-color-danger,#dc3545);--color-danger-dark:var(--theme-color-danger-dark,#bd2130);--color-link:var(--theme-color-link,#007bff);--color-link-light:var(--theme-color-link-light,#0062cc);--color-link-dark:var(--theme-color-link-dark,#3395ff);--color-default:var(--theme-color-default,#f7f7f7);--color-input-placeholder:var(--theme-color-input-placeholder,#c4cfdb);--size-radius:var(--theme-size-radius,0.25rem);--size-margin:var(--theme-size-margin,0.5rem);--size-margin-lg:var(--theme-size-margin-lg,2rem);--size-margin-1-2:var(--theme-size-margin-1-2,0.25rem);--size-margin-1-2-negative:var(--theme-size-margin-1-2-negative,-0.25rem);--font-size-root:var(--theme-font-size-root,20px);--font-size:var(--theme-font-size,0.65rem);--font-size-medium:var(--theme-font-size,0.8rem);--font-size-large:var(--theme-font-size-large,1rem);--font-size-small:var(--theme-font-size-small,0.6rem);--container-width:var(--theme-container-width,55rem)}[data-v-6a32b030]:root,\nuni-page-body[data-v-6a32b030]{--color-primary:var(--theme-color-primary,#698af4);--color-primary-light:var(--theme-color-primary-light,#819df6);--color-primary-dark:var(--theme-color-primary-dark,#5177f2)}.tui-modal-box[data-v-6a32b030]{position:fixed;left:50%;top:50%;margin:auto;background:#fff;z-index:750;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;box-sizing:border-box;visibility:hidden}.tui-modal-scale[data-v-6a32b030]{-webkit-transform:translate(-50%,-50%) scale(0);transform:translate(-50%,-50%) scale(0)}.tui-modal-normal[data-v-6a32b030]{-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}.tui-modal-show[data-v-6a32b030]{opacity:1;visibility:visible}.tui-modal-mask[data-v-6a32b030]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:749;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;visibility:hidden}.tui-mask-show[data-v-6a32b030]{visibility:visible;opacity:1}.tui-modal-title[data-v-6a32b030]{text-align:center;font-size:%?34?%;color:#333;padding-top:%?20?%;font-weight:700}.tui-modal-content[data-v-6a32b030]{text-align:center;color:#999;font-size:%?28?%;padding-top:%?20?%;padding-bottom:%?60?%}.tui-mtop[data-v-6a32b030]{margin-top:%?30?%}.tui-mbtm[data-v-6a32b030]{margin-bottom:%?30?%}.tui-modalBtn-box[data-v-6a32b030]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.tui-flex-column[data-v-6a32b030]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.tui-modal-btn[data-v-6a32b030]{width:46%;height:%?68?%;line-height:%?68?%;position:relative;border-radius:%?10?%;font-size:%?24?%;overflow:visible;margin-left:0;margin-right:0}.tui-modal-btn[data-v-6a32b030]::after{content:"";position:absolute;width:200%;height:200%;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(.5);transform:scale(.5);left:0;top:0;border-radius:%?20?%}.tui-btn-width[data-v-6a32b030]{width:80%!important}.tui-primary[data-v-6a32b030]{background:var(--color-primary);color:#fff}.tui-primary-hover[data-v-6a32b030]{background:#4a67d6;color:#e5e5e5}.tui-primary-outline[data-v-6a32b030]{color:var(--color-primary);background:none}.tui-primary-outline[data-v-6a32b030]::after{border:1px solid var(--color-primary)}.tui-danger[data-v-6a32b030]{background:#ed3f14;color:#fff}.tui-danger-hover[data-v-6a32b030]{background:#d53912;color:#e5e5e5}.tui-danger-outline[data-v-6a32b030]{color:#ed3f14;background:none}.tui-danger-outline[data-v-6a32b030]::after{border:1px solid #ed3f14}.tui-red[data-v-6a32b030]{background:#e41f19;color:#fff}.tui-red-hover[data-v-6a32b030]{background:#c51a15;color:#e5e5e5}.tui-red-outline[data-v-6a32b030]{color:#e41f19;background:none}.tui-red-outline[data-v-6a32b030]::after{border:1px solid #e41f19}.tui-warning[data-v-6a32b030]{background:#ff7900;color:#fff}.tui-warning-hover[data-v-6a32b030]{background:#e56d00;color:#e5e5e5}.tui-warning-outline[data-v-6a32b030]{color:#ff7900;background:none}.tui-warning-outline[data-v-6a32b030]::after{border:1px solid #ff7900}.tui-green[data-v-6a32b030]{background:#19be6b;color:#fff}.tui-green-hover[data-v-6a32b030]{background:#16ab60;color:#e5e5e5}.tui-green-outline[data-v-6a32b030]{color:#19be6b;background:none}.tui-green-outline[data-v-6a32b030]::after{border:1px solid #19be6b}.tui-white[data-v-6a32b030]{background:#fff;color:#333}.tui-white-hover[data-v-6a32b030]{background:#f7f7f9;color:#666}.tui-white-outline[data-v-6a32b030]{color:#333;background:none}.tui-white-outline[data-v-6a32b030]::after{border:1px solid #333}.tui-gray[data-v-6a32b030]{background:#ededed;color:#999}.tui-gray-hover[data-v-6a32b030]{background:#d5d5d5;color:#898989}.tui-gray-outline[data-v-6a32b030]{color:#999;background:none}.tui-gray-outline[data-v-6a32b030]::after{border:1px solid #999}.tui-outline-hover[data-v-6a32b030]{opacity:.6}.tui-circle-btn[data-v-6a32b030]{border-radius:%?40?%!important}.tui-circle-btn[data-v-6a32b030]::after{border-radius:%?80?%!important}',""]),t.exports=a},"0728":function(t,a,e){"use strict";e.d(a,"b",(function(){return o})),e.d(a,"c",(function(){return r})),e.d(a,"a",(function(){return i}));var i={pageMeta:e("6d42").default},o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",[e("v-uni-view",[e("page-meta",{attrs:{"root-font-size":"20px"}}),e("page-header",{attrs:{title:"结算中心"}}),e("v-uni-view",{staticClass:"ub-panel margin-top"},[e("v-uni-view",{staticClass:"head"},[e("v-uni-view",{staticClass:"title"},[t._v("订单详情")])],1),e("v-uni-view",{staticClass:"body"},[e("v-uni-view",{staticClass:"ub-pair"},[e("v-uni-view",{staticClass:"name"},[t._v("订单号")]),e("v-uni-view",{staticClass:"value"},[t._v(t._s(t.info.id))])],1),e("v-uni-view",{staticClass:"ub-pair"},[e("v-uni-view",{staticClass:"name"},[t._v("内容")]),e("v-uni-view",{staticClass:"value"},[t._v(t._s(t.info.body))])],1),e("v-uni-view",{staticClass:"ub-pair"},[e("v-uni-view",{staticClass:"name"},[t._v("金额")]),e("v-uni-view",{staticClass:"value"},[e("span",{staticClass:"ub-text-warning",staticStyle:{"font-size":"1rem"}},[t._v("￥"+t._s(t.info.feeTotal))])])],1)],1)],1),e("v-uni-view",{staticClass:"ub-panel"},[e("v-uni-view",{staticClass:"head"},[e("v-uni-view",{staticClass:"title"},[t._v("点击支付")])],1),e("v-uni-view",{staticClass:"body"},[e("v-uni-view",{staticClass:"ub-list-pay"},[t.config.payAlipayOn?e("v-uni-view",{staticClass:"item",class:{active:"alipay"===t.payType},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.doSubmit("alipay")}}},[e("v-uni-image",{staticClass:"icon",attrs:{src:t.config.siteBase+"/asset/image/pay/alipay.jpg"}}),t._v("支付宝")],1):t._e(),t.config.payWechatOn&&t.isWechat?e("v-uni-view",{staticClass:"item",class:{active:"wechat_mobile"===t.payType},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.doSubmit("wechat_mobile")}}},[e("v-uni-image",{staticClass:"icon",attrs:{src:t.config.siteBase+"/asset/image/pay/wechat.jpg"}}),t._v("微信支付")],1):t._e()],1)],1)],1)],1)],1)},r=[]},"0f14":function(t,a,e){"use strict";e.r(a);var i=e("0728"),o=e("3fdf");for(var r in o)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return o[t]}))}(r);var n,l=e("f0c5"),s=Object(l["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],n);a["default"]=s.exports},"178f":function(t,a,e){"use strict";e.r(a);var i=e("9ac6"),o=e.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(r);a["default"]=o.a},"1df6":function(t,a,e){"use strict";var i;e.d(a,"b",(function(){return o})),e.d(a,"c",(function(){return r})),e.d(a,"a",(function(){return i}));var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{on:{touchmove:function(a){a.stopPropagation(),a.preventDefault(),arguments[0]=a=t.$handleEvent(a)}}},[e("v-uni-view",{staticClass:"tui-modal-box",class:[t.fadein||t.show?"tui-modal-normal":"tui-modal-scale",t.show?"tui-modal-show":""],style:{width:t.width,padding:t.padding,borderRadius:t.radius}},[t.custom?e("v-uni-view",[t._t("default")],2):e("v-uni-view",[t.title?e("v-uni-view",{staticClass:"tui-modal-title"},[t._v(t._s(t.title))]):t._e(),e("v-uni-view",{staticClass:"tui-modal-content",class:[t.title?"":"tui-mtop"],style:{color:t.color,fontSize:t.size+"rpx"}},[t._v(t._s(t.content))]),e("v-uni-view",{staticClass:"tui-modalBtn-box",class:[2!=t.button.length?"tui-flex-column":""]},[t._l(t.button,(function(a,i){return[e("v-uni-button",{key:i+"_0",staticClass:"tui-modal-btn",class:["tui-"+(a.type||"primary")+(a.plain?"-outline":""),2!=t.button.length?"tui-btn-width":"",t.button.length>2?"tui-mbtm":"","circle"==t.shape?"tui-circle-btn":""],attrs:{"hover-class":"tui-"+(a.plain?"outline":a.type||"primary")+"-hover","data-index":i},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.handleClick.apply(void 0,arguments)}}},[t._v(t._s(a.text||"确定"))])]}))],2)],1)],1),e("v-uni-view",{staticClass:"tui-modal-mask",class:[t.show?"tui-mask-show":""],on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.handleClickCancel.apply(void 0,arguments)}}})],1)},r=[]},"3f44":function(t,a,e){"use strict";var i=e("40aa"),o=e.n(i);o.a},"3fdf":function(t,a,e){"use strict";e.r(a);var i=e("ad9f"),o=e.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(r);a["default"]=o.a},"40aa":function(t,a,e){var i=e("0429");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=e("4f06").default;o("a0b70e86",i,!0,{sourceMap:!1,shadowMode:!1})},"4a9c":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.StoreBaseConfigMixin=a.StoreUserMixin=void 0,e("ac1f"),e("5319");var i=e("2f62"),o=e("077c"),r=e("d2b8"),n={computed:(0,i.mapState)({user:function(t){return t.user.user}}),methods:{requireUserLogined:function(t){this.user.id?t():this.$dialog.tipError("请登录",(function(){return o.Router.replace(r.SystemSetting.route.login,{redirect:o.Router.pathWithQueries()})}))}}};a.StoreUserMixin=n;var l={computed:(0,i.mapState)({config:function(t){return t.base.config}})};a.StoreBaseConfigMixin=l},"6d42":function(t,a,e){"use strict";e.r(a);var i=e("d630"),o=e("8f28");for(var r in o)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return o[t]}))}(r);var n,l=e("f0c5"),s=Object(l["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],n);a["default"]=s.exports},"8f28":function(t,a,e){"use strict";e.r(a);var i=e("013c"),o=e.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(r);a["default"]=o.a},"9ac6":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("a9e3");var i={name:"TuiModal",props:{show:{type:Boolean,default:!1},width:{type:String,default:"84%"},padding:{type:String,default:"40rpx 64rpx"},radius:{type:String,default:"24rpx"},title:{type:String,default:""},content:{type:String,default:""},color:{type:String,default:"#999"},size:{type:Number,default:28},shape:{type:String,default:"square"},button:{type:Array,default:function(){return[{text:"取消",type:"primary",plain:!0},{text:"确定",type:"primary",plain:!1}]}},maskClosable:{type:Boolean,default:!0},custom:{type:Boolean,default:!1},fadein:{type:Boolean,default:!1}},data:function(){return{}},methods:{handleClick:function(t){if(this.show){var a=t.currentTarget.dataset;this.$emit("click",{index:Number(a.index)})}},handleClickCancel:function(){this.maskClosable&&this.$emit("cancel")}}};a.default=i},ad9f:function(t,a,e){"use strict";(function(t){var i=e("4ea4").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=e("4a9c"),r=e("379e"),n=i(e("de82")),l={name:"pay",components:{TuiModal:n.default},mixins:[o.StoreBaseConfigMixin],data:function(){return{orderSecretId:null,payType:"",showWechatMiniProgramOauth:!1,info:{id:"",status:"",body:"",redirect:"",freeTotal:""}}},computed:{isWechat:function(){return r.AgentUtil.isWechat()}},onReady:function(){var t=this;this.$starter.boot((function(){return t.init()}))},methods:{init:function(){var a=this;this.orderSecretId=this.$r.getQuery("order"),this.$dialog.loadingOn(),this.$api.post("pay/info",{order:this.orderSecretId},(function(t){a.$dialog.loadingOff(),a.info=t.data.order}),(function(t){return a.$dialog.loadingOff()}));var e=this.$r.parseH5Url(),i=e.param["code"];i||(i=this.$r.getQuery("code"));var o=this.$storage.get("autoClickPayType");i?(this.$dialog.loadingOn(),this.$api.post("oauth/callback",{code:i,type:this.$storage.get("oauthLoginType"),callback:this.$storage.get("oauthLoginCallback"),view:!0},(function(e){a.$dialog.loadingOff(),t.log("oauth callback",e),a.$r.refreshCleanUrl()}),(function(t){a.$dialog.loadingOff(),a.$r.refreshCleanUrl()}))):(t.log("auto click",o),this.doSubmit(o))},doSubmit:function(t){switch(this.payType=t,this.$dialog.loadingOn(),this.payType){case"alipay":this.doSubmitAlipay();break;case"wechat_mobile":this.doSubmitWechatMobile();break;case"wechat_mini_program":this.doSubmitWechatMiniProgram();break}},doSubmitAlipay:function(){var t=this;this.$api.post("pay/submit",{type:this.payType,order:this.orderSecretId},(function(a){t.$dialog.loadingOff(),window.location.href=a.data.payLink}),(function(a){t.$dialog.loadingOff()}))},doSubmitWechatMiniProgram:function(){var a=this;this.$api.post("pay/submit",{type:this.payType,order:this.orderSecretId},(function(e){a.$dialog.loadingOff(),t.log("pay.submit.success",e);var i=e.data.payJsSdkConfig;uni.requestPayment({provider:"wxpay",timeStamp:i.timeStamp,nonceStr:i.nonceStr,package:i.package,signType:i.signType,paySign:i.paySign,success:function(t){"requestPayment:ok"===t.errMsg?(a.$dialog.tipError("支付成功"),a.$r.to(e.data.successRedirect)):a.$dialog.tipError("支付失败："+JSON.stringify(t))},fail:function(t){a.$dialog.tipError("支付取消")}})}),(function(t){a.$dialog.loadingOff(),t.data&&t.data.needOauthLogin&&(a.showWechatMiniProgramOauth=!0)}))},onMpWeixinGetUserInfo:function(a){var e=this;this.$dialog.loadingOn();var i=a.detail;t.log("onMpWeixinGetUserInfo",i),wx.login({success:function(a){e.$dialog.loadingOff(),t.log("loginRes",a),e.$api.post("oauth/login_wechat_mini_program",{view:!0,code:a.code,iv:i.iv,encryptedData:i.encryptedData},(function(t){e.$dialog.loadingOff(),e.showWechatMiniProgramOauth=!1,e.doSubmitWechatMiniProgram()}),(function(t){return e.$dialog.loadingOff()}))},fail:function(t){this.$dialog.loadingOff(),this.$dialog.tipError("登录微信失败")}})},doSubmitWechatMobile:function(){var t=this;this.$storage.remove("autoClickPayType"),this.$api.post("pay/submit",{type:this.payType,order:this.orderSecretId},(function(a){t.$dialog.loadingOff(),WeixinJSBridge.invoke("getBrandWCPayRequest",a.data.payJsSdkConfig,(function(e){"get_brand_wcpay_request:ok"===e.err_msg?(alert("支付成功"),t.$r.to(a.data.successRedirect)):"get_brand_wcpay_request:cancel"===e.err_msg?alert("支付已取消"):alert("支付失败 "+JSON.stringify(e))}))}),(function(a){if(t.$dialog.loadingOff(),a.data&&a.data.needOauthLogin){t.$storage.set("autoClickPayType",t.payType),t.$dialog.loadingOn();var e=t.$r.pathToUrl(t.$r.pathWithQueries());t.$api.post("oauth/login",{type:"wechatmobile",silence:!0,view:!0,callback:e},(function(a){t.$dialog.loadingOff(),t.$storage.set("oauthLoginType","wechatmobile"),t.$storage.set("oauthLoginCallback",e),window.location.href=a.data.redirect}),(function(a){t.$dialog.loadingOff()}))}}))}}};a.default=l}).call(this,e("5a52")["default"])},d630:function(t,a,e){"use strict";var i;e.d(a,"b",(function(){return o})),e.d(a,"c",(function(){return r})),e.d(a,"a",(function(){return i}));var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticStyle:{display:"none"}},[t._t("default")],2)},r=[]},de82:function(t,a,e){"use strict";e.r(a);var i=e("1df6"),o=e("178f");for(var r in o)["default"].indexOf(r)<0&&function(t){e.d(a,t,(function(){return o[t]}))}(r);e("3f44");var n,l=e("f0c5"),s=Object(l["a"])(o["default"],i["b"],i["c"],!1,null,"6a32b030",null,!1,i["a"],n);a["default"]=s.exports}}]);