<?php
/**
 * ------------------------ 
 *  版权所有  www.tecmz.com
 *  商业版本请购买正版授权使用
 * ------------------------
*/ namespace Module\Member\Web\Controller; use Illuminate\Support\Facades\View; use ModStart\App\Web\Layout\WebPage; use ModStart\Core\Input\Request; use ModStart\Field\AbstractField; use ModStart\Field\AutoRenderedFieldValue; use ModStart\Grid\Grid; use ModStart\Module\ModuleBaseController; use ModStart\Module\ModuleManager; use ModStart\Repository\Filter\RepositoryFilter; use Module\Member\Auth\MemberUser; use Module\Member\Support\MemberLoginCheck; class MemberCreditController extends ModuleBaseController implements MemberLoginCheck { private $api; public function __construct() { goto PtdVC; PtdVC: list($this->viewMemberFrame, $eEo37) = $this->viewPaths('member.frame'); goto aaKhG; aOTin: $this->api = app(\Module\Member\Api\Controller\MemberCreditController::class); goto tJaxj; aaKhG: View::share('_viewMemberFrame', $this->viewMemberFrame); goto aOTin; tJaxj: } public function index(WebPage $H1G2d) { goto EaWAZ; u5s6A: $H1G2d->pageTitle('我的' . ModuleManager::getModuleConfig('Member', 'creditName', '积分')); goto sCBxR; au1vE: $RZHSW->repositoryFilter(function (RepositoryFilter $XM5aD) { $XM5aD->where(array('memberUserId' => MemberUser::id())); }); goto tsWP_; tsWP_: $RZHSW->disableCUD()->disableItemOperate(); goto b5SbG; sCBxR: return $H1G2d->view($M1iJt)->body($RZHSW); goto gXglA; Q1LIm: list($M1iJt, $eEo37) = $this->viewPaths('memberCredit.index'); goto u5s6A; EaWAZ: $RZHSW = Grid::make('member_credit_log'); goto au1vE; b5SbG: $RZHSW->useSimple(function (AbstractField $gxoEj, $qlKQK, $mlRDG) { return AutoRenderedFieldValue::makeView('module::Member.View.pc.memberCredit.item', array('item' => $qlKQK)); }); goto cIhbI; cIhbI: if (Request::isPost()) { return $RZHSW->request(); } goto Q1LIm; gXglA: } }