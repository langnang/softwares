/*
 |--------------------------------------------------------------------------
 | SkyCaiji (蓝天采集器)
 |--------------------------------------------------------------------------
 | Copyright (c) 2018 https://www.skycaiji.com All rights reserved.
 |--------------------------------------------------------------------------
 | 使用协议  https://www.skycaiji.com/licenses
 |--------------------------------------------------------------------------
 */
'use strict';function DevelopClass(){this.packTypes={};this.downFrameworkSize=0;this.downFrameworkNum=0}
DevelopClass.prototype={constructor:DevelopClass,release_cms:function(config){var $_o=this;globalOp.inputSelectCustom('#form_cms select[name="cms_name"]','cms_name_custom');$('#add_param').bind('click',function(){windowModal('参数',ulink('develop/cmsAddParam'))});$('#param_list').on('click','.param-key',function(){var parentObj=$(this).parents('tr[id^="param_"]').eq(0);var paramval=parentObj.find('input[name="params[]"]').val();var objid=parentObj.attr('id');windowModal('参数',ulink('develop/cmsAddParam?objid=_objid_&param=_param_',{'_objid_':objid,'_param_':paramval}))});$('#param_list').on('click','.delete-param',function(){$(this).parents('tr').eq(0).remove()});if(config&&!$.isEmptyObject(config)){$('#form_cms [name="name"]').val(config.name);var cmsnameOpt=$('#form_cms [name="cms_name"] option[value="'+config.cms_name+'"]');if(cmsnameOpt.length>0){$('#form_cms [name="cms_name"]').val(config.cms_name)}else{$('#form_cms [name="cms_name"]').val('custom').trigger('change');$('#form_cms [name="cms_name_custom"]').val(config.cms_name)}
$('#form_cms [name="identifier"]').val(config.identifier);$('#form_cms [name="copyright"]').val(config.copyright);if(config.is_edit){$('#form_cms [name="cms_name"]').attr("disabled","disabled");$('#form_cms [name="cms_name_custom"]').attr("disabled","disabled");$('#form_cms [name="identifier"]').attr("disabled","disabled");$('#form_cms [name="copyright"]').attr("disabled","disabled")}
if(config.params){for(var i in config.params){$_o.add_cms_param(config.params[i])}}}},init_cms_param:function(){var $_o=this;$('#win_form_param select[name="param[type]"]').bind('change',function(){$('#win_form_param .param-type-select').hide();var curType=$(this).val();if(curType=='select_val'||curType=='select_func'){$('#win_form_param .param-type-select[data-select="'+curType+'"]').show()}});$('#win_form_param').submit(function(){var checkKey=!0;var curKey=$('#win_form_param [name="param[key]"]').val();var objid=$('#win_form_param input[name="objid"]').val();if(objid){if(curKey==$('#'+objid).find('.param-key').attr('data-val')){checkKey=!1}}
if(checkKey){var hasKey=!1;$('#param_list .param-key').each(function(){if(curKey==$(this).attr('data-val')){hasKey=!0;return!1}});if(hasKey){toastr.error('变量名已存在！');return!1}}
ajaxOpen({type:'POST',dataType:'json',url:$(this).attr('action'),data:$(this).serialize(),success:function(data){if(data.code==1){$_o.add_cms_param(data.data,objid);$('#myModal').modal('hide')}else{toastr.error(data.msg)}},error:function(data){toastr.error(data)}});return!1})},load_cms_param:function(param){if(param){$('#win_form_param [name="param[key]"]').val(param.key);$('#win_form_param [name="param[require]"][value="'+param.require+'"]').prop('checked',!0);$('#win_form_param [name="param[name]"]').val(param.name);$('#win_form_param [name="param[type]"]').val(param.type).trigger('change');$('#win_form_param [name="param[select_val]"]').val(param.select_val);$('#win_form_param [name="param[select_func]"]').val(param.select_func)}},add_cms_param:function(param,objid){var paramHtml='<td><a href="javascript:;" class="param-key" data-val="_keyval_">_key_</a></td><td>_require_</td><td>_name_</td><td>_type_</td>'+'<td><a href="javascript:;" class="glyphicon glyphicon-remove delete-param"></a><input type="hidden" name="params[]" value="_param_"/></td>';paramHtml=paramHtml.replace('_keyval_',param.key).replace('_key_',param.key).replace('_require_',(param.require>0?'是':'否')).replace('_name_',param.name).replace('_type_',param.type_name).replace('_param_',encode_json2urlbase(param));if(objid){$('#'+objid).html(paramHtml)}else{$('#param_list tbody').append('<tr id="param_'+generateUUID()+'">'+paramHtml+'</tr>')}},app:function(app){var $_o=this;$('#newest_version').bind('click',function(){confirmRight('确定升级至新版本？',function(){var app=$('#form_app [name="app"]').val();windowModal('正在升级...',ulink('admin/app/upgrade?app=_app_',{'_app_':app}))})});$('#add_pack').bind('click',function(){windowModal('扩展',ulink('develop/appAddPack'))});$('#pack_list').on('click','.pack-name',function(){var parentObj=$(this).parents('tr[id^="pack_"]').eq(0);var packval=parentObj.find('input[name="packs[]"]').val();var objid=parentObj.attr('id');windowModal('扩展',ulink('develop/appAddPack?objid=_objid_&pack=_pack_',{'_objid_':objid,'_pack_':packval}))});$('#pack_list').on('click','.delete-pack',function(){$(this).parents('tr').eq(0).remove()});globalOp.eleExchange('#pack_list','.move-pack','tr[id^="pack_"]');$('#form_app').on('change','select[name="framework"]',function(){$('[id^="framework_vers_"]').hide();var name=$(this).val();if(name){$('[id^="framework_vers_'+name+'"]').show()}});$('#form_app').on('click','#install_framework',function(){var btnObj=$(this);btnObj.attr('disabled',!0);btnObj.html('<span class="status">正在下载...</span><span class="perct">0</span>%');$_o.down_framework(null)});if(app){if(app.config){var config=app.config;$('#form_app [name="name"]').val(config.name);$('#form_app [name="desc"]').val(config.desc);$('#form_app [name="app"]').val(app.app);$('#form_app [name="website"]').val(config.website);$('#form_app [name="author"]').val(config.author);$('#form_app [name="version"]').val(config.version);$('#form_app [name="phpv"]').val(config.phpv);$('#form_app [name="agreement"]').val(config.agreement);$('#form_app select[name="framework"]').val(config.framework).trigger('change');if(config.framework){$('input[type="radio"][name="framework_version['+config.framework+']"][value="'+config.framework_version+'"]').prop('checked','checked')}
if(config.packs){for(var i in config.packs){$_o.add_app_pack(config.packs[i])}}}
if(app.app_class){var appClass=app.app_class;$('#form_app [name="install"]').val(appClass.install);$('#form_app [name="uninstall"]').val(appClass.uninstall);$('#form_app [name="upgrade"]').val(appClass.upgrade)}}},add_app_pack:function(pack,objid){var packHtml='<td><a href="javascript:;" class="pack-name" data-val="_nameval_">_name_</a></td><td>_type_</td><td>_link_</td><td>'+'<a href="javascript:;" class="glyphicon icon-drag-move move-pack" title="移动"></a>'+'&nbsp;<a href="javascript:;" class="glyphicon glyphicon-remove delete-pack" title="删除"></a>'+'<input type="hidden" name="packs[]" value="_pack_"/></td>';packHtml=packHtml.replace('_nameval_',pack.name).replace('_name_',pack.name).replace('_type_',this.packTypes[pack.type]).replace('_link_',pack.nav_link).replace('_pack_',encode_json2urlbase(pack));if(objid){$('#'+objid).html(packHtml)}else{$('#pack_list tbody').append('<tr id="pack_'+generateUUID()+'">'+packHtml+'</tr>')}},init_app_pack:function(){var $_o=this;$('#win_form_pack').submit(function(){var checkName=!0;var curName=$('#win_form_pack [name="pack[name]"]').val();var objid=$('#win_form_pack input[name="objid"]').val();if(objid){if(curName==$('#'+objid).find('.pack-name').attr('data-val')){checkName=!1}}
if(checkName){var hasName=!1;$('#pack_list .pack-name').each(function(){if(curName==$(this).attr('data-val')){hasName=!0;return!1}});if(hasName){toastr.error('名称已存在！');return!1}}
ajaxOpen({type:'POST',dataType:'json',url:$(this).attr('action'),data:$(this).serialize(),success:function(data){if(data.code==1){$_o.add_app_pack(data.data,objid);$('#myModal').modal('hide')}else{toastr.error(data.msg)}},error:function(data){toastr.error(data)}});return!1});$('#win_form_pack [name="pack[type]"]').bind('change',function(){var type=$(this).val();$(this).siblings('.help-block').each(function(){if($(this).hasClass('type-'+type)){$(this).show()}else{$(this).hide()}})})},load_app_pack:function(pack){if(pack){$('#win_form_pack [name="pack[name]"]').val(pack.name);$('#win_form_pack [name="pack[type]"]').val(pack.type).trigger('change');$('#win_form_pack [name="pack[nav_link]"]').val(pack.nav_link);$('#win_form_pack [name="pack[target]"][value="'+parseInt(pack.target)+'"]').prop('checked','checked')}},down_framework:function(params){var $_o=this;params=params?params:{};var url='develop/installFramework?app='+$('#form_app [name="app"]').val();if(params.block_no){url+='&block_no='+params.block_no}
url=ulink(url);ajaxOpen({type:'get',dataType:'json',url:url,success:function(data){if(data.code==1){var dataData=data.data;dataData=dataData?dataData:{};if(dataData.next_block_no>0){var per=parseInt(parseFloat(dataData.next_block_no/dataData.blocks)*100);$('#install_framework').find('.perct').text(per);$_o.down_framework({'block_no':dataData.next_block_no})}else{$('#install_framework').find('.perct').text('100');ajaxDataMsg(data)}}else{$('#install_framework').attr('disabled',!1).html('下载失败');if(data.msg){toastr.error(data.msg)}}},error:function(){$('#install_framework').attr('disabled',!1).html('下载失败')}})},func:function(module,config){var $_o=this;$('#add_method').bind('click',function(){$_o.func_add_method()});$('#form_func').on('click','.delete-method',function(){$(this).parents('tr').remove()});$('#form_func').on('change','[name="module"]',function(){var val=$(this).val();if(val=='downloadImg'||val=='downloadFile'){$('.method-tips-url').show().find('em').text(val=='downloadImg'?'图片':'文件')}else{$('.method-tips-url').hide()}});if(module){$('#form_func [name="module"]').val(module)}
var moduleReadonly=!1;if(config&&!$.isEmptyObject(config)){for(var i in config){$('#form_func [name="'+i+'"]').val(config[i])}
moduleReadonly=!0;$('#form_func [name="identifier"]').attr('readonly','readonly');$('#form_func [name="copyright"]').attr('readonly','readonly')}
var moduleVal=$('#form_func [name="module"]').val();if(moduleVal){$('#form_func [name="module"]').trigger('change')}
if(moduleReadonly){$('#form_func [name="module"]').attr('readonly','readonly').attr('onfocus','this.defaultIndex=this.selectedIndex;').attr('onchange','this.selectedIndex=this.defaultIndex;')}},func_add_method:function(method,desc){method=method?method:'';desc=desc?desc:'';var tr='<tr><td><input type="text" name="methods[method][]" value="'+htmlspecialchars(method)+'" class="form-control" /></td>'+'<td><input type="text" name="methods[comment][]" class="form-control" value="'+htmlspecialchars(desc)+'" /></td>'+'<td><a href="javascript:;" class="glyphicon glyphicon-remove delete-method" style="margin-top:8px;"></a></td></tr>';$('#form_func table.method_list tbody').append(tr)},api:function(module,config){var $_o=this;var fid='#form_api';$('#add_variable').bind('click',function(){windowModal('添加'+window.tpl_lang.apiapp_op_variable,ulink('develop/apiVariable'),{lg:1})});$('#add_request').bind('click',function(){windowModal('添加'+window.tpl_lang.apiapp_op_request,ulink('develop/apiRequest'),{lg:1})});globalOp.eleExchange('#op_list','.op-move','tr[id^="op_"]');$('#op_list').on('click','.op-delete',function(){var curObj=$(this);confirmRight('确定删除？',function(){curObj.parents('tr[id^="op_"]').remove()})});$('#op_list').on('click','.op-info',function(){var curTr=$(this).parents('tr[id^="op_"]').eq(0);var op=curTr.find('[name="ops[]"]').val();op=decode_urlbase2json(op);var module=op.module;var config=op.config;config=encode_json2urlbase(config);var objid=curTr.attr('id');if(module=='variable'){windowModal('编辑'+window.tpl_lang.apiapp_op_variable,ulink('develop/apiVariable'),{lg:1,ajax:{data:{objid:objid,variable:config}}})}else if(module=='request'){windowModal('编辑'+window.tpl_lang.apiapp_op_request,ulink('develop/apiRequest'),{lg:1,ajax:{data:{objid:objid,request:config}}})}});$_o.api_insert_variable(fid,null,!0);$('#btn_api_test').bind('click',function(){var app=$(this).attr('data-app');if(app){windowModal('测试接口插件',ulink('develop/apiTest?app=_app_',{'_app_':app}),{lg:1})}else{prompt_error('请先保存！')}});if(config&&!$.isEmptyObject(config)){var ops=config.ops;delete config.ops;globalOp.loadFormConfig(fid,config);$(fid+' [name="module"]').attr('readonly','readonly').attr('onfocus','this.defaultIndex=this.selectedIndex;').attr('onchange','this.selectedIndex=this.defaultIndex;');$(fid+' [name="identifier"]').attr('readonly','readonly');$(fid+' [name="copyright"]').attr('readonly','readonly');if(isObject(ops)){for(var i in ops){var op=ops[i];if(isObject(op)){$_o.api_add_op(op.module,op.config)}}}}},api_test:function(app){$('#win_form_api_test').bind('submit',function(){var resultObj=$('#win_api_result').find('.panel-body');resultObj.html('');$('#win_api_result').hide();var settings=getFormAjaxSettings($(this));var oldSuccess=settings.success;settings.success=function(data){oldSuccess(data);if(data.code==1){data=data.data;if(isObject(data)){$('#win_api_result').show();var opData=isObject(data.data)?data.data:{};var tpl='<div class="form-group"><label></label><textarea rows="3" class="form-control"></textarea></div>';var obj=$(tpl);if(data.success){obj.find('label').text('最终数据');obj.find('textarea').val(opData.content);resultObj.append(obj)}else{obj.find('label').text('错误信息');obj.find('textarea').val(data.msg);resultObj.append(obj)}
if(opData.ops){for(var i in opData.ops){obj=$(tpl);var opName=i.split(':');if(opName[1]=='###'){continue}
obj.find('label').text(window.tpl_lang['apiapp_op_'+opName[0]]+'：'+opName[1]);obj.find('textarea').val(opData.ops[i]);resultObj.append(obj)}}}}};ajaxOpen(settings);return!1});pluginApiOp.load({module:'process',boxObj:$('#win_form_api_test'),appObj:'#api_apps',appApp:app,isTest:!0,})},api_ops:function(objid,onlyVariable){var varNames=[];var ops=[];$('#op_list').find('tr[id^="op_"]').each(function(){if(objid&&objid==$(this).attr('id')){return!1}
var op=$(this).find('[name="ops[]"]').val();op=decode_urlbase2json(op);if(isObject(op)){var module=op.module;var config=op.config;if(isObject(config)){if(module=='variable'){if(onlyVariable){varNames.push(config.name)}else{ops.push('variable:'+config.name)}}else if(module=='request'){ops.push('request:'+config.name)}}}});return onlyVariable?varNames:ops},api_add_op:function(module,config,objid){config=config?config:{};var trObj=null;if(objid){trObj=$('#'+objid)}else{trObj=$('#tpl_op').clone();trObj.attr('id','op_'+generateUUID());$('#op_list tbody').append(trObj)}
trObj.find('.op-module').text(window.tpl_lang['apiapp_op_'+module]);var info='';if(module=='variable'){info=window.tpl_lang['apiapp_variable_m_'+config.module]+' » '+config.name;if(config.module=='user'&&isObject(config.user)&&toInt(config.user.global)>0){info+='（全局配置）'}}else if(module=='request'){info=config.name+'（'+config.url+'）'}
trObj.find('.op-info').text(info);var op={module:module,config:config};op=encode_json2urlbase(op);trObj.find('[name="ops[]"]').val(op)},api_insert_variable:function(fid,objid,allOps){var $_o=this;allOps=allOps?true:!1;$(fid).on('click','.api-insert-variable-btn a.dropdown-toggle',function(){var opNames=$_o.api_ops(objid,allOps?false:!0);var curBox=$(this).parents('.api-insert-variable').eq(0);var html='';if(isObject(opNames)){for(var i in opNames){var opName=opNames[i];var opModule='';if(allOps){opName=opName.split(':');opModule=window.tpl_lang['apiapp_op_'+opName[0]];opName=opName[1]}else{opModule=window.tpl_lang.apiapp_op_variable}
opName=htmlspecialchars(opName);html+='<li><a href="javascript:;" data-val="['+opModule+':'+opName+']">'+opModule+'：'+opName+'</a></li>'}}
html=html?html:'<li><a href="javascript:;">无</a></li>';if(!allOps){html+='<li><a href="javascript:;"><b>只能调用当前位置之前的变量</b></a></li>'}
curBox.find('.dropdown-menu').html(html).find('a[data-val]').bind('click',function(){var val=$(this).attr('data-val');if(val){globalOp.insertAtCaret(curBox.find('input,textarea'),val)}})})},api_init_variable:function(variable){var $_o=this;var fid='#win_form_variable';$(fid).bind('submit',function(){ajaxOpen({type:'POST',dataType:'json',url:$(this).attr('action'),data:$(this).serialize(),success:function(data){if(data.code==1){data=data.data;var objid=data.objid;var vconfig=data.variable;vconfig=isObject(vconfig)?vconfig:{};var nameRepeat=!1;$('#op_list').find('tr[id^="op_"]').each(function(){var opVal=$(this).find('[name="ops[]"]').val();opVal=decode_urlbase2json(opVal);if(isObject(opVal)&&isObject(opVal.config)){if(opVal.module=='variable'){if(opVal.config.name==vconfig.name){if(!objid||$(this).attr('id')!=objid){nameRepeat=!0;return!1}}}}});if(nameRepeat){prompt_error('变量名称已经存在！')}else{$_o.api_add_op('variable',vconfig,objid);$('#myModal').modal('hide')}}else{prompt_error(data.msg)}}});return!1});$(fid+' [name="variable[module]"]').bind('change',function(){var module=$(this).val();module=module?module:'';$(fid).find('.variable-module').hide();$(fid).find('.variable-module[data-module="'+module+'"]').show()});$(fid+' [name="variable[user][tag]"]').bind('change',function(){if($(this).val()=='select'){$(fid).find('.variable-user-tag-select').show()}else{$(fid).find('.variable-user-tag-select').hide()}});$(fid+' [name="variable[extract][type]"]').bind('change',function(){$(fid+' .variable-module-extract[data-extract-module]').hide();$(fid+' .variable-module-extract[data-extract-module="'+$(this).val()+'"]').show()});$.datetimepicker.setLocale('zh');$(fid+' input[name="variable[time][start]"],'+fid+' input[name="variable[time][end]"]').datetimepicker();$(fid+' .variable-time-format').on('click','a[data-val]',function(){globalOp.insertAtCaret($(fid+' [name="variable[time][format]"]'),$(this).attr('data-val'))});var objid=$(fid).find('[name="objid"]').val();var apiOps=$_o.api_ops(objid,!1);if(isObject(apiOps)){var html='';for(var i in apiOps){var apiOp=apiOps[i].split(':');html+='<option value="'+htmlspecialchars(apiOps[i])+'">'+window.tpl_lang['apiapp_op_'+apiOp[0]]+'：'+htmlspecialchars(apiOp[1])+'</option>'}
$(fid).find('[name="variable[extract][source]"]').append(html)}
$_o.api_insert_variable(fid,objid);$(fid+' .variable-func-add').bind('click',function(){$_o.api_add_variable_func(fid,objid)});globalOp.eleExchange(fid+' #variable_func','.variable-func-move','tr[id^="variable_func_"]');$(fid+' #variable_func').on('click','.variable-func-del',function(){var curObj=this;confirmRight('确定删除？',function(){$(curObj).parents('tr[id^="variable_func_"]').eq(0).remove()})});$(fid+' #variable_func').on('change','.variable-func-param',function(){var curTr=$(this).parents('tr[id^="variable_func_"]').eq(0);var curVal=$(this).val();if(curVal){globalOp.insertAtCaret(curTr.find('[name="variable[func][params][]"]'),$(this).val())}});ruleInsertSign.cpRuleModuleInit(fid,'variable[extract]','');if(isObject(variable)){var funcConfig=variable.func;delete variable.func;var varExtract=null;if(variable.module=='extract'){varExtract=variable.extract;if(isObject(varExtract)){variable.extract={source:varExtract.source,type:varExtract.type};delete varExtract.source;delete varExtract.type}}
globalOp.loadFormConfig($(fid),variable,'variable');if(variable.module=='extract'){ruleInsertSign.cpRuleModuleLoad(fid,'variable[extract]','',varExtract)}
if(isObject(funcConfig)){if(toInt(funcConfig.open)>0){globalOp.showPanelCollapse('#variable_func')}
$(fid+' [name="variable[func][open]"][value="'+funcConfig.open+'"]').prop('checked',!0);if(isObject(funcConfig.names)){funcConfig.params=isObject(funcConfig.params)?funcConfig.params:[];for(var i in funcConfig.names){$_o.api_add_variable_func(fid,objid,funcConfig.names[i],funcConfig.params[i])}}}}},api_add_variable_func:function(fid,objid,funcName,funcParam){var tr=$('#tpl_variable_func').clone();tr.attr('id','variable_func_'+generateUUID());var varNames=this.api_ops(objid,!0);var html='';for(var i in varNames){varNames[i]=htmlspecialchars(varNames[i]);html+='<option value="['+window.tpl_lang.apiapp_op_variable+':'+varNames[i]+']">'+varNames[i]+'</option>'}
tr.find('.variable-func-param').html(tr.find('.variable-func-param').html()+html+'<optgroup label="只能调用当前位置之前的变量"> </optgroup>');if(funcName){tr.find('[name="variable[func][names][]"]').val(funcName)}
if(funcParam){tr.find('[name="variable[func][params][]"]').val(funcParam)}
$(fid+' #variable_func tbody').append(tr)},api_init_request:function(request){var $_o=this;var fid='#win_form_request';$(fid).bind('submit',function(){ajaxOpen({type:'POST',dataType:'json',url:$(this).attr('action'),data:$(this).serialize(),success:function(data){if(data.code==1){data=data.data;var objid=data.objid;var rconfig=data.request;rconfig=isObject(rconfig)?rconfig:{};var nameRepeat=!1;$('#op_list').find('tr[id^="op_"]').each(function(){var opVal=$(this).find('[name="ops[]"]').val();opVal=decode_urlbase2json(opVal);if(isObject(opVal)&&isObject(opVal.config)){if(opVal.module=='request'){if(opVal.config.name==rconfig.name){if(!objid||$(this).attr('id')!=objid){nameRepeat=!0;return!1}}}}});if(nameRepeat){prompt_error('请求名称已经存在！')}else{$_o.api_add_op('request',rconfig,objid);$('#myModal').modal('hide')}}else{prompt_error(data.msg)}}});return!1});globalOp.inputSelectCustom(fid+' [name="request[charset]"]','request[charset_custom]');globalOp.inputSelectCustom(fid+' [name="request[encode]"]','request[encode_custom]');$(fid).find('[name="request[type]"]').bind('change',function(){if($(this).val()=='post'){$(fid).find('.request-type-post').show()}else{$(fid).find('.request-type-post').hide()}});$(fid+' .request-param-add').bind('click',function(){var trObj=$('#tpl_request_param').clone();trObj.removeAttr('id');$(fid+' .request-param-list').append(trObj)});$(fid+' .request-header-add').bind('click',function(){var trObj=$('#tpl_request_header').clone();trObj.removeAttr('id');$(fid+' .request-header-list').append(trObj)});$(fid).on('click','.request-param-delete',function(){var curObj=$(this);confirmRight('确定删除？',function(){curObj.parents('tr').eq(0).remove()})});$(fid).on('click','.request-header-delete',function(){var curObj=$(this);confirmRight('确定删除？',function(){curObj.parents('tr').eq(0).remove()})});$_o.api_insert_variable(fid,$(fid).find('[name="objid"]').val());if(isObject(request)){if(isObject(request.param_names)){request.param_vals=isObject(request.param_vals)?request.param_vals:[];for(var i in request.param_names){var trObj=$('#tpl_request_param').clone();trObj.removeAttr('id');trObj.find('[name="request[param_names][]"]').val(request.param_names[i]);trObj.find('[name="request[param_vals][]"]').val(request.param_vals[i]);$(fid+' .request-param-list').append(trObj)}}
if(isObject(request.header_names)){request.header_vals=isObject(request.header_vals)?request.header_vals:[];for(var i in request.header_names){var trObj=$('#tpl_request_header').clone();trObj.removeAttr('id');trObj.find('[name="request[header_names][]"]').val(request.header_names[i]);trObj.find('[name="request[header_vals][]"]').val(request.header_vals[i]);$(fid+' .request-header-list').append(trObj)}}
delete request.param_names;delete request.param_vals;delete request.header_names;delete request.header_vals;globalOp.loadFormConfig($('#win_form_request'),request,'request')}}}
var developClass=new DevelopClass()